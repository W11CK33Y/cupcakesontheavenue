<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover"/>
<title>Cupcakes on the Avenue - Premium Baked Goods & Custom Cakes | Highworth Market</title>
<meta name="description" content="Artisan cupcakes, custom celebration cakes & exclusive Shortbread Delights. Visit us at Highworth Market Saturdays or order online. Fresh baked goods made with love.">
<meta name="keywords" content="cupcakes, cakes, bakery, Highworth, custom cakes, shortbread, celebration cakes, fresh baked goods, artisan bakery">
<meta name="author" content="Cupcakes on the Avenue">
<meta name="robots" content="index, follow">

<!-- PWA Meta Tags -->
<meta name="theme-color" content="#667eea">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Cupcakes Avenue">
<meta name="mobile-web-app-capable" content="yes">
<meta name="format-detection" content="telephone=no">

<!-- Web App Manifest -->
<link rel="manifest" href="manifest.json">

<!-- Apple Touch Icons -->
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üßÅ</text></svg>">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://cupcakesontheavenue.co.uk">
<meta property="og:title" content="Cupcakes on the Avenue - Premium Baked Goods & Custom Cakes">
<meta property="og:description" content="Artisan cupcakes, custom celebration cakes & exclusive Shortbread Delights. Visit us at Highworth Market or order online.">
<meta property="og:image" content="https://cupcakesontheavenue.co.uk/pictures/logo.png">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://cupcakesontheavenue.co.uk">
<meta property="twitter:title" content="Cupcakes on the Avenue - Premium Baked Goods & Custom Cakes">
<meta property="twitter:description" content="Artisan cupcakes, custom celebration cakes & exclusive Shortbread Delights. Visit us at Highworth Market or order online.">
<meta property="twitter:image" content="https://cupcakesontheavenue.co.uk/pictures/logo.png">

<!-- Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Bakery",
  "name": "Cupcakes on the Avenue",
  "description": "Artisan bakery specializing in cupcakes, custom celebration cakes, and exclusive Shortbread Delights",
  "url": "https://cupcakesontheavenue.co.uk",
  "telephone": "07842817789",
  "email": "cupcakesontheavenue@gmail.com",
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "Highworth",
    "addressCountry": "UK"
  },
  "openingHours": "Sa 08:00-14:00",
  "paymentAccepted": "Cash, Card, Online Payment",
  "priceRange": "¬£3-¬£70",
  "servesCuisine": "Bakery",
  "hasMenu": {
    "@type": "Menu",
    "hasMenuSection": [
      {
        "@type": "MenuSection",
        "name": "Regular Bakes",
        "hasMenuItem": [
          {
            "@type": "MenuItem",
            "name": "Shortbread Delight",
            "description": "Our signature buttery, melt-in-your-mouth shortbread",
            "offers": {
              "@type": "Offer",
              "price": "20-30",
              "priceCurrency": "GBP"
            }
          }
        ]
      }
    ]
  }
}
</script>

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'GA_MEASUREMENT_ID');
  
  // Custom events for tracking
  function trackPurchase(orderTotal, items) {
    gtag('event', 'purchase', {
      transaction_id: Math.random().toString(36).substr(2, 9),
      value: orderTotal,
      currency: 'GBP',
      items: items.map(item => ({
        item_id: item.name.toLowerCase().replace(/\s+/g, '_'),
        item_name: item.name,
        category: 'Baked Goods',
        quantity: item.quantity,
        price: item.price
      }))
    });
  }
  
  function trackProductView(productName) {
    gtag('event', 'view_item', {
      currency: 'GBP',
      value: 0,
      items: [{
        item_id: productName.toLowerCase().replace(/\s+/g, '_'),
        item_name: productName,
        category: 'Baked Goods',
        quantity: 1
      }]
    });
  }
  
  function trackAddToCart(productName, price) {
    gtag('event', 'add_to_cart', {
      currency: 'GBP',
      value: price,
      items: [{
        item_id: productName.toLowerCase().replace(/\s+/g, '_'),
        item_name: productName,
        category: 'Baked Goods',
        quantity: 1,
        price: price
      }]
    });
  }
</script>

<link rel="icon" type="image/x-icon" href="pictures/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="pictures/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="pictures/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="pictures/apple-touch-icon.png">
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

html {
  overflow-x: hidden;
  width: 100%;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  color: #333;
  transition: background 1s ease-in-out;
  position: relative;
  overflow-x: hidden;
  margin: 0;
  padding: 0;
  width: 100%;
  max-width: 100vw;
}

/* Christmas Winter Theme - Falling Snow Animation */
body::before {
  content: '‚ùÑÔ∏è';
  position: fixed;
  top: -50px;
  left: 10%;
  font-size: 20px;
  color: rgba(255, 255, 255, 0.8);
  animation: snowfall 10s linear infinite;
  z-index: 1;
  pointer-events: none;
}

body::after {
  content: '‚≠ê';
  position: fixed;
  top: -50px;
  right: 15%;
  font-size: 18px;
  color: rgba(255, 215, 0, 0.9);
  animation: snowfall 12s linear infinite 2s;
  z-index: 1;
  pointer-events: none;
}

@keyframes snowfall {
  0% {
    transform: translateY(0) rotate(0deg);
    opacity: 1;
  }
  100% {
    transform: translateY(100vh) rotate(360deg);
    opacity: 0.3;
  }
}

/* Christmas Winter Theme - Override seasonal themes */
body.spring,
body.summer,
body.autumn,
body.winter {
  /* Winter Christmas gradient with purple brand colors */
  background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #4a5d7c 100%);
  position: relative;
}

/* Add subtle snowflake pattern overlay */
body.winter::before,
body.spring::before,
body.summer::before,
body.autumn::before {
  content: '‚ùÑÔ∏è ‚ú® üéÑ';
  position: fixed;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 30px;
  opacity: 0.15;
  animation: gentleFloat 6s ease-in-out infinite;
  pointer-events: none;
  z-index: 0;
}

@keyframes gentleFloat {
  0%, 100% { transform: translateX(-50%) translateY(0); }
  50% { transform: translateX(-50%) translateY(-10px); }
}

/* Header - Christmas Winter Theme */
header {
  background: rgba(255, 255, 255, 0.98);
  padding: 20px;
  text-align: center;
  box-shadow: 0 4px 15px rgba(0,0,0,0.15);
  border-bottom: 3px solid rgba(102, 126, 234, 0.3);
  position: relative;
}

header::before {
  content: 'üéÑ';
  position: absolute;
  left: 20px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 40px;
  opacity: 0.7;
}

header::after {
  content: 'üéÑ';
  position: absolute;
  right: 20px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 40px;
  opacity: 0.7;
}

header h1 {
  color: #667eea;
  font-size: 2.5rem;
  margin-bottom: 10px;
  text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
}

header h1::before {
  content: '‚ùÑÔ∏è ';
}

header h1::after {
  content: ' ‚ùÑÔ∏è';
}

header p {
  color: #666;
  font-size: 1.1rem;
  margin-bottom: 15px;
}

nav a {
  color: #667eea;
  text-decoration: none;
  margin: 0 15px;
  font-weight: 600;
  transition: color 0.3s;
}

nav a:hover {
  color: #764ba2;
}

/* Hero */
.hero {
  text-align: center;
  padding: 60px 20px;
  color: white;
}

.hero img {
  max-width: 300px;
  border-radius: 15px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  margin-bottom: 20px;
}

.hero h2 {
  font-size: 2.5rem;
  margin-bottom: 10px;
}

.hero p {
  font-size: 1.3rem;
  opacity: 0.9;
}

/* Sections - Christmas Winter Theme */
section {
  max-width: 1400px;
  margin: 40px auto;
  padding: 40px 20px;
  background: rgba(255, 255, 255, 0.3);
  backdrop-filter: blur(15px);
  border-radius: 25px;
  box-shadow: 0 15px 35px rgba(0,0,0,0.15), 0 5px 15px rgba(0,0,0,0.08);
  border: 2px solid rgba(255, 255, 255, 0.4);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  color: #2c3e50;
}

section p, section li, section label {
  text-shadow: 0 1px 2px rgba(255, 255, 255, 0.7);
}

/* Christmas sparkle border */
section::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 5px;
  background: linear-gradient(90deg, #667eea, #ffd700, #764ba2, #ffd700, #667eea);
  background-size: 200% 100%;
  animation: shimmer 3s linear infinite;
  background-size: 200% 100%;
  animation: gradientShift 3s ease-in-out infinite;
}

section:hover {
  transform: translateY(-5px);
  box-shadow: 0 20px 40px rgba(0,0,0,0.18), 0 10px 20px rgba(0,0,0,0.12);
  background: rgba(255, 255, 255, 0.35);
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* Seasonal Section Adaptations */
body.spring section {
  background: rgba(255, 255, 255, 0.20);
  border: 1px solid rgba(144, 238, 144, 0.25);
  box-shadow: 0 15px 35px rgba(50, 205, 50, 0.12), 0 5px 15px rgba(50, 205, 50, 0.06);
}

body.spring section::before {
  background: linear-gradient(90deg, #90EE90, #32CD32, #90EE90);
  background-size: 200% 100%;
  animation: gradientShift 3s ease-in-out infinite;
}

body.summer section {
  background: rgba(255, 255, 255, 0.20);
  border: 1px solid rgba(255, 225, 53, 0.25);
  box-shadow: 0 15px 35px rgba(255, 165, 0, 0.12), 0 5px 15px rgba(255, 165, 0, 0.06);
}

body.summer section::before {
  background: linear-gradient(90deg, #FFE135, #FFA500, #FFE135);
  background-size: 200% 100%;
  animation: gradientShift 3s ease-in-out infinite;
}

body.autumn section {
  background: rgba(255, 255, 255, 0.20);
  border: 1px solid rgba(255, 107, 53, 0.25);
  box-shadow: 0 15px 35px rgba(255, 107, 53, 0.12), 0 5px 15px rgba(255, 107, 53, 0.06);
}

body.autumn section::before {
  background: linear-gradient(90deg, #FF6B35, #8B4513, #FF6B35);
  background-size: 200% 100%;
  animation: gradientShift 3s ease-in-out infinite;
}

body.winter section {
  background: rgba(255, 255, 255, 0.20);
  border: 1px solid rgba(176, 224, 230, 0.25);
  box-shadow: 0 15px 35px rgba(70, 130, 180, 0.12), 0 5px 15px rgba(70, 130, 180, 0.06);
}

body.winter section::before {
  background: linear-gradient(90deg, #B0E0E6, #4682B4, #B0E0E6);
  background-size: 200% 100%;
  animation: gradientShift 3s ease-in-out infinite;
}

/* Floating Particle Effect for Sections */
section::after {
  content: '';
  position: absolute;
  top: 10px;
  right: 20px;
  width: 6px;
  height: 6px;
  background: rgba(102, 126, 234, 0.3);
  border-radius: 50%;
  animation: float 4s ease-in-out infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.3; }
  50% { transform: translateY(-10px) rotate(180deg); opacity: 0.7; }
}

/* Enhanced Glass Effect on Hover */
section:hover {
  background: rgba(255, 255, 255, 0.35);
  backdrop-filter: blur(20px);
}

/* Seasonal Particle Colors */
body.spring section::after {
  background: rgba(50, 205, 50, 0.4);
}

body.summer section::after {
  background: rgba(255, 165, 0, 0.4);
}

body.autumn section::after {
  background: rgba(255, 107, 53, 0.4);
}

body.winter section::after {
  background: rgba(70, 130, 180, 0.4);
}

section h2 {
  text-align: center;
  font-size: 2.5rem;
  color: #667eea;
  margin-bottom: 40px;
  text-shadow: 0 2px 4px rgba(255, 255, 255, 0.8);
  font-weight: 700;
}

/* Product Tiles */
.products-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 30px;
}

.product-tile {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 20px;
  overflow: hidden;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.23, 1, 0.320, 1);
  position: relative;
  height: 350px;
  border: 2px solid rgba(255, 255, 255, 0.2);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.product-tile::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
  transform: translateX(-100%);
  transition: transform 0.6s;
}

.product-tile:hover::before {
  transform: translateX(100%);
}

.product-tile:hover {
  transform: translateY(-15px) scale(1.02);
  box-shadow: 0 20px 50px rgba(102, 126, 234, 0.3);
  border-color: rgba(255, 255, 255, 0.4);
}

/* Seasonal Product Tile Styles */
body.spring .product-tile {
  background: linear-gradient(135deg, #90EE90 0%, #32CD32 100%);
}

body.spring .product-tile:hover {
  box-shadow: 0 20px 50px rgba(50, 205, 50, 0.3);
}

body.summer .product-tile {
  background: linear-gradient(135deg, #FFE135 0%, #FFA500 100%);
}

body.summer .product-tile:hover {
  box-shadow: 0 20px 50px rgba(255, 165, 0, 0.3);
}

body.autumn .product-tile {
  background: linear-gradient(135deg, #FF6B35 0%, #8B4513 100%);
}

body.autumn .product-tile:hover {
  box-shadow: 0 20px 50px rgba(255, 107, 53, 0.3);
}

body.winter .product-tile {
  background: linear-gradient(135deg, #B0E0E6 0%, #4682B4 100%);
}

body.winter .product-tile:hover {
  box-shadow: 0 20px 50px rgba(70, 130, 180, 0.3);
}

.product-tile img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.product-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.95);
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: 25px;
  opacity: 0;
  transition: opacity 0.3s;
}

.product-tile:hover .product-overlay {
  opacity: 1;
}

.product-title {
  font-size: 1.5rem;
  font-weight: bold;
  color: #667eea;
  margin-bottom: 10px;
}

.product-description {
  color: #666;
  font-size: 1rem;
  line-height: 1.5;
  flex: 1;
}

.product-select {
  width: 100%;
  padding: 12px;
  border: 2px solid #667eea;
  border-radius: 8px;
  font-size: 1rem;
  margin-bottom: 10px;
  background: white;
}

.add-btn {
  width: 100%;
  padding: 14px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 1.1rem;
  font-weight: bold;
  cursor: pointer;
  transition: transform 0.2s;
}

.add-btn:hover {
  transform: scale(1.05);
}

/* Size Comparison Tooltip */
.size-tooltip {
  position: absolute;
  background: #333;
  color: white;
  padding: 15px;
  border-radius: 8px;
  font-size: 0.9rem;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
  z-index: 1000;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s;
  max-width: 200px;
}

.size-tooltip.show {
  opacity: 1;
}

.size-visual {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 8px;
}

.size-circle {
  background: #667eea;
  border-radius: 50%;
  display: inline-block;
}

.size-6 { width: 20px; height: 20px; }
.size-8 { width: 26px; height: 26px; }
.size-10 { width: 32px; height: 32px; }

/* Cart */
.cart-section {
  max-width: 800px;
  margin: 40px auto;
  background: rgba(255, 255, 255, 0.25);
  backdrop-filter: blur(15px);
  border-radius: 25px;
  padding: 35px;
  box-shadow: 0 15px 35px rgba(0,0,0,0.15), 0 5px 15px rgba(0,0,0,0.08);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.cart-section::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #667eea, #764ba2, #667eea);
  background-size: 200% 100%;
  animation: gradientShift 3s ease-in-out infinite;
}

.cart-section:hover {
  transform: translateY(-5px);
  box-shadow: 0 20px 40px rgba(0,0,0,0.15), 0 10px 20px rgba(0,0,0,0.1);
}

@keyframes cartHighlight {
  0% { box-shadow: 0 15px 35px rgba(0,0,0,0.15), 0 5px 15px rgba(0,0,0,0.08); }
  50% { box-shadow: 0 20px 50px rgba(102, 126, 234, 0.3), 0 10px 25px rgba(102, 126, 234, 0.2); }
  100% { box-shadow: 0 15px 35px rgba(0,0,0,0.15), 0 5px 15px rgba(0,0,0,0.08); }
}

.cart-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
  padding-bottom: 20px;
  border-bottom: 2px solid #f0f0f0;
}

.cart-header h2 {
  color: #667eea;
  margin: 0;
}

#itemCount {
  background: #667eea;
  color: white;
  padding: 8px 15px;
  border-radius: 20px;
  font-weight: bold;
}

.cart-items ul {
  list-style: none;
}

.cart-items li {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px;
  margin-bottom: 10px;
  background: #f8f9fa;
  border-radius: 10px;
}

.cart-controls {
  display: flex;
  gap: 10px;
}

.cart-btn {
  width: 35px;
  height: 35px;
  border: 2px solid #667eea;
  background: white;
  color: #667eea;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.2s;
}

.cart-btn:hover {
  background: #667eea;
  color: white;
}

.cart-total {
  display: flex;
  justify-content: space-between;
  padding: 20px;
  background: #f8f9fa;
  border-radius: 10px;
  font-size: 1.5rem;
  font-weight: bold;
  color: #667eea;
  margin-top: 20px;
}

.customer-form input,
.customer-form select,
.customer-form textarea {
  width: 100%;
  padding: 12px;
  margin: 10px 0;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 1rem;
}

.customer-form input:focus,
.customer-form select:focus {
  border-color: #667eea;
  outline: none;
}

.checkbox-group {
  margin: 15px 0;
}

.checkbox-group label {
  display: flex;
  align-items: center;
  margin: 8px 0;
  cursor: pointer;
}

.checkbox-group input[type="checkbox"] {
  width: auto;
  margin-right: 10px;
}

.order-btn {
  width: 100%;
  padding: 18px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.2rem;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
  position: relative;
  overflow: hidden;
}

/* Christmas sparkle effect on buttons */
.order-btn::before {
  content: '‚ú®';
  position: absolute;
  left: 10px;
  opacity: 0.6;
}

.order-btn::after {
  content: '‚ú®';
  position: absolute;
  right: 10px;
  opacity: 0.6;
  font-weight: bold;
  cursor: pointer;
  margin-top: 20px;
  transition: transform 0.2s;
}

.order-btn:hover {
  transform: scale(1.02);
  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
}

/* Calendar */
.calendar-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.7);
  z-index: 999;
}

.calendar-popup {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  padding: 30px;
  border-radius: 15px;
  box-shadow: 0 10px 50px rgba(0,0,0,0.3);
  z-index: 1000;
  max-width: 400px;
  width: 90%;
}

.calendar-nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.calendar-nav button {
  background: #667eea;
  color: white;
  border: none;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
}

.calendar-nav span {
  font-size: 1.2rem;
  font-weight: bold;
  color: #667eea;
}

#calendar table {
  width: 100%;
  border-collapse: collapse;
}

#calendar th,
#calendar td {
  padding: 10px;
  text-align: center;
  border: 1px solid #e0e0e0;
}

#calendar th {
  background: #667eea;
  color: white;
  font-weight: bold;
}

#calendar td {
  cursor: pointer;
  transition: background 0.2s;
}

#calendar td:hover:not(.disabled) {
  background: #e8eaf6;
}

#calendar td.disabled {
  color: #ccc;
  cursor: not-allowed;
  background: #f5f5f5;
}

#calendar td.weekend {
  background: #fff3e0;
}

.close-calendar {
  position: absolute;
  top: 10px;
  right: 15px;
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #667eea;
}

/* Toast */
#toast {
  visibility: hidden;
  min-width: 300px;
  background: #667eea;
  color: white;
  text-align: center;
  border-radius: 10px;
  padding: 16px;
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10000;
  font-size: 1rem;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
  opacity: 0;
  transition: opacity 0.3s, visibility 0.3s;
}

#toast.show {
  visibility: visible;
  opacity: 1;
}

/* Snowflakes */
.snowflake {
  position: fixed;
  top: -10vh;
  color: white;
  font-size: 20px;
  pointer-events: none;
  z-index: 10000;
  animation: fall linear infinite, sway ease-in-out infinite;
}

@keyframes fall {
  to { transform: translateY(120vh); }
}

@keyframes sway {
  0%, 100% { margin-left: 0; }
  50% { margin-left: 50px; }
}

/* Market Section */
.market-toggle {
  display: block;
  margin: 0 auto 30px;
  padding: 15px 40px;
  background: #667eea;
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.2rem;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.3s;
}

.market-toggle:hover {
  background: #764ba2;
}

.market-bakes {
  display: none;
}

.market-bakes.show {
  display: block;
}

.social-links {
  text-align: center;
  margin-top: 30px;
}

.social-icons {
  display: flex;
  gap: 20px;
  justify-content: center;
  margin-top: 15px;
}

.social-icons a {
  transition: transform 0.2s;
}

.social-icons a:hover {
  transform: scale(1.2);
}

/* Footer */
footer {
  background: white;
  text-align: center;
  padding: 40px 20px;
  margin-top: 60px;
  box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
}

footer img {
  max-width: 200px;
  margin-top: 20px;
  border-radius: 10px;
}

/* Special Request */
#special-request form input,
#special-request form textarea {
  width: 100%;
  padding: 12px;
  margin: 10px 0;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 1rem;
}

#special-request form button {
  width: 100%;
  padding: 15px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.1rem;
  font-weight: bold;
  cursor: pointer;
  margin-top: 10px;
}

/* New lead time section styles */
.leadtime-group {
  margin: 15px 0;
  padding: 12px;
  background: #f8f9fa;
  border-radius: 10px;
  border: 1px solid #e0e0e0;
}

.leadtime-group p {
  margin-bottom: 8px;
  color: #444;
  font-weight: 600;
}

.leadtime-group label {
  margin-right: 15px;
  font-weight: 500;
}

.leadtime-note {
  margin-top: 8px;
  color: #b45309; /* amber */
  background: #fffbeb;
  border: 1px solid #fde68a;
  padding: 8px 10px;
  border-radius: 8px;
}

.site-footer {
  margin-top: 40px;
  padding: 30px 20px;
  background: rgba(247, 247, 248, 0.25);
  backdrop-filter: blur(15px);
  border-top: 1px solid rgba(234, 234, 234, 0.3);
  text-align: center;
  color: #333;
  border-radius: 25px 25px 0 0;
  border-top: 3px solid rgba(255, 215, 0, 0.4);
}

/* Christmas footer decorations */
.site-footer::after {
  content: 'üéÑ ‚ùÑÔ∏è ‚≠ê ‚ùÑÔ∏è üéÑ';
  position: absolute;
  top: -15px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 24px;
  background: rgba(255, 255, 255, 0.9);
  padding: 5px 20px;
  border-radius: 20px;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  position: relative;
}

.site-footer::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, #667eea, #ffd700, #764ba2, #ffd700, #667eea);
  background-size: 200% 100%;
  animation: shimmer 3s linear infinite;
}

.site-footer nav {
  margin-bottom: 15px;
}

.site-footer nav a {
  margin: 0 15px;
  color: #0b66c3;
  text-decoration: none;
  transition: all 0.3s ease;
  padding: 8px 12px;
  border-radius: 8px;
}

.site-footer nav a:hover { 
  text-decoration: underline;
  background: rgba(11, 102, 195, 0.1);
  transform: translateY(-2px);
}






/* Wishlist Heart Icon */
.wishlist-heart {
  position: absolute;
  top: 15px;
  right: 15px;
  font-size: 24px;
  cursor: pointer;
  transition: all 0.3s;
  z-index: 100;
  color: #ccc;
}

.wishlist-heart:hover,
.wishlist-heart.loved {
  color: #ff6b6b;
  transform: scale(1.2);
}

.product-tile {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 15px;
  overflow: hidden;
  cursor: pointer;
  transition: transform 0.3s, box-shadow 0.3s;
  position: relative;
  height: 350px;
}

/* Recommended Products */
.recommendations-section {
  background: #f8f9fa;
  padding: 30px;
  border-radius: 15px;
  margin: 30px 0;
}

.recommendations-section h3 {
  color: #667eea;
  margin-bottom: 20px;
  text-align: center;
}

.recommendations-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
}

.recommendation-item {
  background: white;
  border-radius: 10px;
  padding: 15px;
  text-align: center;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  transition: transform 0.3s;
}

.recommendation-item:hover {
  transform: translateY(-5px);
}

.recommendation-item img {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  object-fit: cover;
  margin-bottom: 10px;
}

/* Loading Animations */
.loading-spinner {
  border: 4px solid #f3f3f3;
  border-top: 4px solid #667eea;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
  margin: 20px auto;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.skeleton {
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
}

@keyframes loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

.skeleton-product {
  height: 350px;
  border-radius: 15px;
  margin-bottom: 20px;
}

.skeleton-text {
  height: 20px;
  margin: 10px 0;
  border-radius: 4px;
}

.skeleton-title {
  height: 24px;
  width: 80%;
  margin: 15px auto;
  border-radius: 4px;
}

.fade-in {
  animation: fadeIn 0.5s ease-in;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.slide-in {
  animation: slideIn 0.6s ease-out;
}

@keyframes slideIn {
  from { transform: translateX(-100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

.zoom-in {
  animation: zoomIn 0.4s ease-out;
}

@keyframes zoomIn {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

/* Popular Items Dashboard */
.popular-badge {
  position: absolute;
  top: 10px;
  left: 10px;
  background: linear-gradient(45deg, #FF6B6B, #FF8E8E);
  color: white;
  padding: 5px 10px;
  border-radius: 15px;
  font-size: 0.8rem;
  font-weight: bold;
  z-index: 10;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

.trending-indicator {
  position: absolute;
  top: 10px;
  right: 50px;
  background: #FFD700;
  color: #333;
  padding: 3px 8px;
  border-radius: 10px;
  font-size: 0.7rem;
  font-weight: bold;
  z-index: 10;
}

.popular-dashboard {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 30px;
  border-radius: 20px;
  margin: 40px auto;
  max-width: 1200px;
  text-align: center;
}

.popular-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.stat-card {
  background: rgba(255, 255, 255, 0.1);
  padding: 20px;
  border-radius: 15px;
  backdrop-filter: blur(10px);
}

.stat-number {
  font-size: 2rem;
  position: relative;
  display: inline-block;
}

/* Add Christmas decorations to section titles */
section h2::before {
  content: '‚ú® ';
  color: #ffd700;
}

section h2::after {
  content: ' ‚ú®';
  color: #ffd700;

@keyframes shimmer {
  0% { background-position: 0% 50%; }
  100% { background-position: 200% 50%; }
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Multiple animated snowflakes for winter wonderland effect */
body {
  --snowflake-1: '‚ùÑÔ∏è';
  --snowflake-2: '‚≠ê';
  --snowflake-3: '‚ú®';
}

/* Create 6 snowflakes across the page */
nav::before,
nav::after {
  content: '‚ùÑÔ∏è';
  position: fixed;
  color: rgba(255, 255, 255, 0.7);
  font-size: 16px;
  animation: snowfall 8s linear infinite;
  pointer-events: none;
  z-index: 9999;
}

nav::before {
  top: -30px;
  left: 25%;
  animation-delay: 1s;
  animation-duration: 11s;
}

nav::after {
  top: -30px;
  right: 25%;
  animation-delay: 3s;
  animation-duration: 9s;
  content: '‚≠ê';
  color: rgba(255, 215, 0, 0.8);
}

/* Winter Market Special with Countdown */
.countdown-banner {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 30px 20px;
  text-align: center;
  margin: 20px auto;
  border-radius: 20px;
  position: relative;
  overflow: hidden;
  box-shadow: 0 8px 32px rgba(102, 126, 234, 0.3);
  max-width: 1200px;
}

.countdown-banner.winter-special {
  background: linear-gradient(135deg, #2c5f99 0%, #1e3a5f 100%);
  border: 3px solid rgba(255, 255, 255, 0.3);
}

.countdown-banner h3,
.countdown-banner p {
  position: relative;
  z-index: 2;
  margin-left: auto;
  margin-right: auto;
}

.snow-overlay {
  position: absolute;
  top: 10px;
  left: 0;
  right: 0;
  font-size: 2rem;
  opacity: 0.3;
  animation: snowfall 10s linear infinite;
  pointer-events: none;
}

@keyframes snowfall {
  0% { transform: translateY(-20px); }
  100% { transform: translateY(100vh); }
}

.countdown-banner::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.15), transparent);
  animation: shimmer 3s infinite;
}

@keyframes shimmer {
  0% { left: -100%; }
  100% { left: 100%; }
}

.countdown-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  background: rgba(255, 255, 255, 0.2);
  padding: 15px 20px;
  border-radius: 12px;
  min-width: 70px;
  backdrop-filter: blur(10px);
  border: 2px solid rgba(255, 255, 255, 0.3);
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

.countdown-number {
  font-size: 2rem;
  font-weight: bold;
  line-height: 1;
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.countdown-label {
  font-size: 0.85rem;
  margin-top: 5px;
  opacity: 0.9;
  text-transform: uppercase;
  letter-spacing: 1px;
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

.countdown-timer {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 10px;
}

.countdown-unit {
  background: rgba(255, 255, 255, 0.2);
  padding: 10px 15px;
  border-radius: 10px;
  min-width: 60px;
}

.countdown-number {
  font-size: 1.5rem;
  font-weight: bold;
}

/* Sticky Cart Bar */
.sticky-cart {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background: rgba(255, 255, 255, 0.98);
  backdrop-filter: blur(10px);
  border-bottom: 2px solid #667eea;
  padding: 15px 20px;
  z-index: 999;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 2px 20px rgba(0,0,0,0.1);
  transform: translateY(-100%);
  transition: transform 0.3s ease;
}

.sticky-cart.show {
  transform: translateY(0);
}

.cart-summary {
  display: flex;
  align-items: center;
  gap: 20px;
}

.cart-icon {
  font-size: 1.5rem;
  color: #667eea;
}

.cart-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.cart-count {
  font-weight: bold;
  color: #333;
}

.cart-total {
  color: #667eea;
  font-size: 0.9rem;
}

.mini-checkout-btn {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 25px;
  font-weight: bold;
  cursor: pointer;
  transition: transform 0.2s;
  text-decoration: none;
  display: inline-block;
}

.mini-checkout-btn:hover {
  transform: scale(1.05);
}

.mini-checkout-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.countdown-label {
  font-size: 0.8rem;
  opacity: 0.9;
}

.limited-offer {
  position: absolute;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  background: #FF4444;
  color: white;
  padding: 5px 15px;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: bold;
  animation: bounce 1s infinite alternate;
}

@keyframes bounce {
  0% { transform: translateX(-50%) translateY(0); }
  100% { transform: translateX(-50%) translateY(-5px); }
}

@media (max-width: 768px) {
  /* Mobile App-Style Optimizations */
  body {
    padding-top: 140px; /* More space for sticky cart on mobile */
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
  }
  
  /* App-style header */
  header {
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(102, 126, 234, 0.2);
    box-shadow: 0 2px 20px rgba(0,0,0,0.1);
    margin-bottom: 15px;
    padding: 15px;
  }
  
  header h1 {
    font-size: 1.8rem;
    margin-bottom: 8px;
  }
  
  header p {
    font-size: 0.9rem;
    margin-bottom: 10px;
  }
  
  /* App-style navigation */
  nav {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
    background: rgba(102, 126, 234, 0.1);
    border-radius: 20px;
    padding: 8px;
    margin-top: 10px;
    max-width: 100%;
    overflow-x: auto;
  }
  
  nav a {
    padding: 8px 10px;
    border-radius: 15px;
    font-size: 0.75rem;
    transition: all 0.3s ease;
    white-space: nowrap;
    min-width: fit-content;
    flex-shrink: 0;
  }
  
  nav a:hover, nav a.active {
    background: rgba(102, 126, 234, 0.2);
    transform: scale(1.05);
  }
  

  
  /* Mobile sections */
  section {
    margin: 15px 10px;
    padding: 25px 15px;
    border-radius: 20px;
  }
  
  section h2 {
    font-size: 1.8rem;
    margin-bottom: 20px;
  }
  
  /* Single column grid for mobile */
  .products-grid {
    grid-template-columns: 1fr;
    gap: 15px;
  }
  
  .product-tile {
    height: 300px;
    border-radius: 18px;
  }
  
  /* Mobile hero */
  .hero {
    padding: 30px 15px;
  }
  
  .hero h2 {
    font-size: 1.8rem;
  }
  
  .hero p {
    font-size: 1.1rem;
  }
  
  .hero img {
    max-width: 250px;
  }
  
  /* Mobile sticky cart */
  .sticky-cart {
    padding: 12px 15px;
    border-bottom: 1px solid rgba(102, 126, 234, 0.2);
  }
  
  .cart-summary {
    gap: 15px;
  }
  
  .cart-icon {
    font-size: 1.3rem;
  }
  
  .cart-count, .cart-total {
    font-size: 0.9rem;
  }
  
  .mini-checkout-btn {
    padding: 8px 15px;
    font-size: 0.9rem;
  }
  
  /* Mobile-friendly buttons */
  .add-btn, .order-btn {
    padding: 12px;
    font-size: 1rem;
    border-radius: 12px;
  }
  
  /* Hide mouse hover effects on touch devices */
  .product-tile:hover {
    transform: none;
  }
  
  /* Touch-friendly tap effects */
  .product-tile:active {
    transform: scale(0.98);
    transition: transform 0.1s ease;
  }
  
  .add-btn:active, .order-btn:active {
    transform: scale(0.95);
  }
}

/* Extra small screens - full app experience */
@media (max-width: 480px) {
  header h1 {
    font-size: 1.5rem;
  }
  
  nav a {
    font-size: 0.75rem;
    padding: 6px 8px;
  }
  
  section {
    margin: 10px 5px;
    padding: 20px 12px;
  }
  
  .hero {
    padding: 20px 10px;
  }
  
  .hero h2 {
    font-size: 1.5rem;
  }

  /* Checkout form mobile optimization */
  .customer-form input[type="text"],
  .customer-form input[type="email"],
  .customer-form input[type="tel"],
  .customer-form input[type="date"],
  .customer-form textarea {
    font-size: 16px !important; /* Prevents zoom on iOS */
  }

  .customer-form label[style*="display: flex"] span {
    font-size: 0.9rem;
    line-height: 1.3;
  }

  .customer-form label[style*="display: flex"] strong {
    display: block;
    margin-bottom: 2px;
  }
}

/* Product Reviews & Ratings */
.product-rating {
  display: flex;
  align-items: center;
  gap: 8px;
  margin: 8px 0;
  font-size: 14px;
}

.stars {
  color: #fbbf24;
  font-size: 16px;
  letter-spacing: 2px;
}

.rating-count {
  color: #666;
  font-size: 13px;
}

.reviews-section {
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(15px);
  border-radius: 20px;
  padding: 40px;
  margin: 40px auto;
  max-width: 1000px;
  border: 1px solid rgba(102, 126, 234, 0.2);
  box-shadow: 0 8px 32px rgba(102, 126, 234, 0.15);
}

.review-card {
  background: white;
  border-radius: 15px;
  padding: 25px;
  margin: 20px 0;
  box-shadow: 0 4px 15px rgba(0,0,0,0.08);
  border: 1px solid #f0f0f0;
  transition: all 0.3s ease;
}

.review-card:hover {
  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.15);
  transform: translateY(-2px);
}

.review-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
}

.reviewer-name {
  font-weight: 600;
  color: #333;
}

.review-date {
  color: #999;
  font-size: 13px;
}

.review-stars {
  color: #fbbf24;
  margin: 8px 0;
  font-size: 18px;
  letter-spacing: 2px;
}

.review-text {
  color: #555;
  line-height: 1.6;
  margin-top: 10px;
}

.verified-badge {
  background: #10b981;
  color: white;
  font-size: 11px;
  padding: 3px 8px;
  border-radius: 10px;
  margin-left: 8px;
}

.write-review-btn {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 10px;
  font-weight: bold;
  cursor: pointer;
  margin-top: 20px;
  transition: transform 0.2s;
}

.write-review-btn:hover {
  transform: translateY(-2px);
}

.review-form {
  background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
  border-radius: 15px;
  padding: 30px;
  margin-top: 25px;
  display: none;
  border: 2px solid #667eea;
  box-shadow: 0 4px 20px rgba(102, 126, 234, 0.1);
}

.review-form.active {
  display: block;
}

.rating-input {
  display: flex;
  flex-direction: row-reverse;
  justify-content: center;
  gap: 8px;
  margin: 15px 0;
}

.rating-input input[type="radio"] {
  display: none;
}

.rating-input label {
  font-size: 40px;
  color: #d1d5db;
  cursor: pointer;
  transition: all 0.2s;
  text-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.rating-input label:hover {
  color: #fbbf24;
  transform: scale(1.2);
}

.rating-input input[type="radio"]:checked ~ label {
  color: #fbbf24;
}

.rating-input label:hover,
.rating-input label:hover ~ label {
  color: #fbbf24;
}

@media (max-width: 480px) {
  .review-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 5px;
  }
  
  .reviews-section {
    padding: 20px 15px;
  }
}

/* Live Notifications & Status Banners */
.live-notification {
  position: fixed;
  top: 80px;
  left: 50%;
  transform: translateX(-50%) translateY(-120%);
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 20px 30px;
  border-radius: 15px;
  box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4);
  z-index: 9998;
  min-width: 300px;
  max-width: 600px;
  transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  border: 2px solid rgba(255, 255, 255, 0.3);
  backdrop-filter: blur(10px);
}

.live-notification.show {
  transform: translateX(-50%) translateY(0);
}

.live-notification.market-open {
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
}

.live-notification.market-closed {
  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
}

.live-notification.announcement {
  background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
}

.live-notification.poll {
  background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
}

.notification-icon {
  font-size: 2rem;
  margin-bottom: 10px;
  animation: bounce 1s infinite;
}

@keyframes bounce {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

.notification-title {
  font-size: 1.3rem;
  font-weight: bold;
  margin-bottom: 8px;
  text-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

.notification-message {
  font-size: 1rem;
  line-height: 1.5;
  opacity: 0.95;
}

.market-status-banner {
  position: fixed;
  top: 70px;
  left: 0;
  right: 0;
  width: 100%;
  max-width: 100vw;
  padding: 15px 20px;
  text-align: center;
  font-weight: bold;
  font-size: 1.1rem;
  z-index: 998;
  transform: translateY(-100%);
  transition: transform 0.5s ease;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  overflow: hidden;
}

.market-status-banner.show {
  transform: translateY(0);
}

.market-status-banner.open {
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
  color: white;
}

.market-status-banner.closed {
  background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
  color: white;
}

.poll-container {
  position: fixed;
  bottom: 100px;
  right: 20px;
  background: white;
  border-radius: 15px;
  padding: 20px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.15);
  max-width: 350px;
  z-index: 997;
  transform: translateX(120%);
  transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  border: 2px solid #8b5cf6;
}

.poll-container.show {
  transform: translateX(0);
}

.poll-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 2px solid #f0f0f0;
}

.poll-title {
  font-size: 1.2rem;
  font-weight: bold;
  color: #8b5cf6;
}

.poll-close-btn {
  background: none;
  border: none;
  font-size: 1.5rem;
  color: #999;
  cursor: pointer;
  padding: 0;
  width: 30px;
  height: 30px;
  border-radius: 50%;
  transition: all 0.2s;
}

.poll-close-btn:hover {
  background: #f0f0f0;
  color: #333;
}

.poll-option {
  padding: 12px 15px;
  margin: 10px 0;
  background: #f8f9fa;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  position: relative;
  overflow: hidden;
}

.poll-option:hover {
  background: #e9ecef;
  border-color: #8b5cf6;
  transform: translateX(5px);
}

.poll-option.voted {
  background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
  color: white;
  border-color: #7c3aed;
}

.poll-option-text {
  font-weight: 600;
  margin-bottom: 5px;
}

.poll-votes {
  font-size: 0.9rem;
  color: #666;
}

.poll-option.voted .poll-votes {
  color: rgba(255,255,255,0.9);
}

.poll-progress {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 4px;
  background: #8b5cf6;
  transition: width 0.5s ease;
}

@media (max-width: 768px) {
  .live-notification {
    top: 60px;
    min-width: 280px;
    max-width: calc(100vw - 40px);
    padding: 15px 20px;
  }
  
  .poll-container {
    bottom: 80px;
    right: 10px;
    left: 10px;
    max-width: calc(100vw - 20px);
  }
  
  .market-status-banner {
    top: 60px;
    font-size: 1rem;
    padding: 12px 15px;
  }
}
</style>
</head>
<body>

<!-- Live Notification Toast -->
<div class="live-notification" id="liveNotification">
  <div class="notification-icon" id="notificationIcon">üì¢</div>
  <div class="notification-title" id="notificationTitle">Notification</div>
  <div class="notification-message" id="notificationMessage">Message</div>
</div>

<!-- Market Status Banner -->
<div class="market-status-banner" id="marketStatusBanner">
  <span id="marketStatusText">üè™ Market Status</span>
</div>

<!-- Poll Widget -->
<div class="poll-container" id="pollContainer">
  <div class="poll-header">
    <div class="poll-title">üç∞ Vote for Next Flavor!</div>
    <button class="poll-close-btn" onclick="closePoll()">√ó</button>
  </div>
  <div id="pollOptions"></div>
</div>

<!-- Sticky Cart Bar -->
<div class="sticky-cart" id="stickyCart">
  <div class="cart-summary">
    <div class="cart-icon">üõí</div>
    <div class="cart-info">
      <div class="cart-count" id="stickyCartCount">0 items</div>
      <div class="cart-total" id="stickyCartTotal">¬£0.00</div>
    </div>
  </div>
  <div style="display: flex; gap: 10px; align-items: center;">
    <button onclick="scrollToCart()" class="mini-checkout-btn" style="background: #667eea; border: none; cursor: pointer;">View Cart</button>
    <a href="shop.html" class="mini-checkout-btn">Go to Shop</a>
  </div>
</div>

<header role="banner">
  <h1>üßÅ Cupcakes on the Avenue</h1>
  <p>Home of the exclusive Shortbread Delight & cosy bakes!</p>
  <nav role="navigation" aria-label="Main navigation">
    <a href="#about" aria-label="Learn about us">About</a>
    <a href="#festive" aria-label="View festive bakes">Festive Bakes</a>
    <a href="shop.html" aria-label="Browse our shop">Shop</a>
    <a href="#market" aria-label="Visit us at market">Market</a>
  </nav>
</header>

<!-- Cart Section - Shows when items are added -->
<div id="order" class="cart-section" style="display: none;">
  <div class="cart-header">
    <h2>üõí Your Cart</h2>
    <span id="itemCount">0 items</span>
  </div>

  <div class="cart-items" id="cartContents">
    <p style="text-align: center; color: #999; padding: 30px;">Your cart is empty</p>
  </div>

  <div class="cart-total">
    <span>Total:</span>
    <span id="cartTotal">¬£0.00</span>
  </div>

  <div class="customer-form">
    <h3 style="color: #667eea; margin: 25px 0 15px;">Customer Details</h3>
    <input type="text" id="customerName" name="customerName" placeholder="Full Name *" autocomplete="name" required style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e0e0e0; border-radius: 8px;">
    <input type="email" id="customerEmail" name="customerEmail" placeholder="Email Address *" autocomplete="email" required style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e0e0e0; border-radius: 8px;">
    <input type="tel" id="customerMobile" name="customerMobile" placeholder="Mobile Number *" autocomplete="tel" required style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e0e0e0; border-radius: 8px;">
    <input type="text" id="customerAddress" name="customerAddress" placeholder="Delivery Address (if delivery selected)" autocomplete="street-address" style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e0e0e0; border-radius: 8px;">
    
    <h3 style="color: #667eea; margin: 20px 0 15px 0;">Delivery & Collection</h3>
    
    <div style="margin-bottom: 15px;">
      <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #555;">Delivery Method *</label>
      <div style="display: flex; flex-direction: column; gap: 10px;">
        <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; background: #f8f9fa;">
          <input type="radio" name="deliveryMethod" value="delivery" required style="margin-right: 10px;" checked>
          <span><strong>üöö Home Delivery</strong> - Any day of the week</span>
        </label>
        <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; background: #f8f9fa;">
          <input type="radio" name="deliveryMethod" value="market" required style="margin-right: 10px;">
          <span><strong>üè™ Collect from Highworth Market</strong> - Saturdays only 8 AM - 2 PM <span style="color: #27ae60; font-weight: bold;">(FREE)</span></span>
        </label>
        <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; background: #f8f9fa;">
          <input type="radio" name="deliveryMethod" value="collect" required style="margin-right: 10px;">
          <span><strong>üè† Collect from Me</strong> - Any day by arrangement <span style="color: #27ae60; font-weight: bold;">(FREE)</span></span>
        </label>
      </div>
    </div>
    
    <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #555;">Preferred Date *</label>
    <input type="date" id="deliveryDate" name="deliveryDate" required style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e0e0e0; border-radius: 8px;">
    <p id="dateInfo" style="color: #666; font-size: 0.9rem; margin-top: -5px; margin-bottom: 15px;">Minimum 7 days notice required. Home delivery available any day of the week.</p>
    
    <textarea id="customerNotes" name="customerNotes" rows="3" placeholder="Special Requests (optional)" style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e0e0e0; border-radius: 8px;"></textarea>
    
    <div style="margin: 20px 0;">
      <label style="display: flex; align-items: center; margin: 8px 0; cursor: pointer;">
        <input type="checkbox" id="termsCheck" name="termsCheck" required style="margin-right: 10px;">
        I agree to the <a href="terms.html" target="_blank" style="color: #667eea;">Terms & Conditions</a> *
      </label>
    </div>

    <button id="placeOrderBtn" style="width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 10px; font-size: 1.2rem; font-weight: bold; cursor: pointer; margin-top: 20px;">
      Place Order & Pay
    </button>
  </div>
</div>

<div class="hero">
  <img src="pictures/logo.png" alt="Cupcakes on the Avenue">
  <h2>Where every bake feels like home</h2>
  <p>Fresh cupcakes, biscuits, and celebration cakes baked with love!</p>
</div>

<!-- Christmas Light Switch-On Event with Countdown -->
<div class="countdown-banner winter-special" id="countdownBanner">
  <div class="snow-overlay">‚ùÑÔ∏è ‚ú® üéÑ ‚ú® ‚ùÑÔ∏è</div>
  <h3>üéÑ‚ú® Christmas Light Switch-On Event! ‚ú®üéÑ</h3>
  <p style="font-size: 1.2rem; margin: 10px 0; font-weight: 600; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
    Next Saturday, 29th November ‚Ä¢ Starting 10am
  </p>
  <p style="font-size: 1rem; margin: 5px 0; opacity: 0.95;">
    Join us at Highworth Market for festive fun, delicious treats & the magical light switch-on!
  </p>
  
  <!-- Countdown Timer -->
  <div id="marketCountdown" style="display: flex; justify-content: center; gap: 15px; margin: 20px 0; font-size: 1.1rem;">
    <div class="countdown-item">
      <span id="days" class="countdown-number">0</span>
      <span class="countdown-label">Days</span>
    </div>
    <div class="countdown-item">
      <span id="hours" class="countdown-number">0</span>
      <span class="countdown-label">Hours</span>
    </div>
    <div class="countdown-item">
      <span id="minutes" class="countdown-number">0</span>
      <span class="countdown-label">Mins</span>
    </div>
    <div class="countdown-item">
      <span id="seconds" class="countdown-number">0</span>
      <span class="countdown-label">Secs</span>
    </div>
  </div>

  <div class="market-special-details" style="display: flex; justify-content: center; align-items: center; gap: 20px; margin-top: 15px; flex-wrap: wrap;">
    <div style="background: rgba(255,255,255,0.3); padding: 12px 20px; border-radius: 15px; backdrop-filter: blur(5px); border: 2px solid rgba(255,255,255,0.4);">
      <strong>üéÅ Special Offers</strong><br>
      <small>Festive treats & goodies</small>
    </div>
    <div style="background: rgba(255,255,255,0.3); padding: 12px 20px; border-radius: 15px; backdrop-filter: blur(5px); border: 2px solid rgba(255,255,255,0.4);">
      <strong>‚ú® Light Switch-On</strong><br>
      <small>Magical Christmas moment</small>
    </div>
    <div style="background: rgba(255,255,255,0.3); padding: 12px 20px; border-radius: 15px; backdrop-filter: blur(5px); border: 2px solid rgba(255,255,255,0.4);">
      <strong>ÔøΩ Family Fun</strong><br>
      <small>Festive atmosphere for all</small>
    </div>
  </div>
</div>

<section id="about">
  <h2>About Us</h2>
  <p style="text-align: center; font-size: 1.2rem; line-height: 1.8; max-width: 800px; margin: 0 auto; color: #666;">
    At Cupcakes on the Avenue, every bake feels like home. From our exclusive Shortbread Delight to cupcakes, biscuits, and cakes made for celebrating, everything is baked with love and a sprinkle of fun. Find us at Highworth Market every Saturday or order online for custom treats.
  </p>
</section>

<section id="festive">
  <h2>üéÑ Festive Bakes</h2>
  <div class="products-grid" style="justify-items: center;">
    
    <div class="product-tile">
      <div class="wishlist-heart" data-product="Christmas Cake with Royal Icing">‚ô°</div>
      <img src="pictures/marzipan.jpg" alt="Christmas Cake">
      <div class="product-overlay">
        <div>
          <div class="product-title">Christmas Cake with Royal Icing</div>
          <div class="product-rating">
            <span class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
            <span class="rating-count">(12 reviews)</span>
          </div>
          <div class="product-description">Traditional Christmas cake with elegant royal icing. Available with or without alcohol.</div>
        </div>
        <div>
          <select class="product-select" data-id="festive-1">
            <option value="6 inch|30" selected>6 inch - ¬£30</option>
            <option value="8 inch|40">8 inch - ¬£40</option>
          </select>
          <button class="add-btn" data-name="Christmas Cake - Royal Icing" data-id="festive-1">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="product-tile">
      <div class="wishlist-heart" data-product="Christmas Cake with Marzipan">‚ô°</div>
      <img src="pictures/fondant.jpg" alt="Marzipan Cake">
      <div class="product-overlay">
        <div>
          <div class="product-title">Christmas Cake with Marzipan</div>
          <div class="product-rating">
            <span class="stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
            <span class="rating-count">(15 reviews)</span>
          </div>
          <div class="product-description">Rich fruit cake with marzipan and fondant icing. With or without alcohol.</div>
        </div>
        <div>
          <select class="product-select" data-id="festive-2">
            <option value="6 inch|30" selected>6 inch - ¬£30</option>
            <option value="8 inch|40">8 inch - ¬£40</option>
          </select>
          <button class="add-btn" data-name="Christmas Cake - Marzipan" data-id="festive-2">Add to Cart</button>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- Popular Items Dashboard -->
<div class="popular-dashboard">
  <h2>üìä Popular This Week</h2>
  <p>See what everyone's loving right now!</p>
  
  <div class="popular-stats">
    <div class="stat-card">
      <div class="stat-number" id="totalOrders">47</div>
      <div>Orders This Week</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" id="popularItem">Shortbread Delight</div>
      <div>Most Popular Item</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" id="trendingItem">Cupcakes</div>
      <div>Trending Now</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" id="avgRating">5.0‚òÖ</div>
      <div>Average Rating</div>
    </div>
  </div>
</div>

<!-- Customer Reviews -->
<section class="reviews-section">
  <h2 style="text-align: center; color: #667eea; margin-bottom: 10px;">‚≠ê Customer Reviews</h2>
  <p style="text-align: center; color: #666; margin-bottom: 25px;">See what our customers are saying</p>
  
  <div id="reviewsContainer">
    <div style="text-align: center; padding: 30px; color: #666;">
      <div class="loading-spinner" style="display: inline-block; width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite;"></div>
      <p style="margin-top: 15px;">Loading reviews...</p>
    </div>
  </div>

  <div style="text-align: center;">
    <button class="write-review-btn" onclick="toggleReviewForm()">Write a Review</button>
    
    <div class="review-form" id="reviewForm">
      <h3 style="color: #667eea; margin-bottom: 15px;">Share Your Experience</h3>
      <div>
        <label style="display: block; margin-bottom: 5px; font-weight: 600;">Your Rating *</label>
        <div class="rating-input">
          <input type="radio" name="rating" value="5" id="star5">
          <label for="star5">‚òÖ</label>
          <input type="radio" name="rating" value="4" id="star4">
          <label for="star4">‚òÖ</label>
          <input type="radio" name="rating" value="3" id="star3">
          <label for="star3">‚òÖ</label>
          <input type="radio" name="rating" value="2" id="star2">
          <label for="star2">‚òÖ</label>
          <input type="radio" name="rating" value="1" id="star1">
          <label for="star1">‚òÖ</label>
        </div>
      </div>
      <input type="text" id="reviewName" placeholder="Your Name *" style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e0e0e0; border-radius: 8px;">
      <input type="email" id="reviewEmail" placeholder="Your Email *" style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e0e0e0; border-radius: 8px;">
      <select id="reviewProduct" style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e0e0e0; border-radius: 8px;">
        <option value="">Select Product (optional)</option>
        <option value="Shortbread Delight">Shortbread Delight</option>
        <option value="Christmas Cake - Royal Icing">Christmas Cake - Royal Icing</option>
        <option value="Christmas Cake - Marzipan">Christmas Cake - Marzipan</option>
        <option value="Iced Shortbread">Iced Shortbread</option>
        <option value="Cupcakes">Cupcakes</option>
        <option value="Rice Crispy Treats">Rice Crispy Treats</option>
        <option value="Other">Other</option>
      </select>
      <textarea id="reviewText" placeholder="Your Review *" rows="4" style="width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #e0e0e0; border-radius: 8px; resize: vertical;"></textarea>
      <div style="display: flex; gap: 10px; margin-top: 15px;">
        <button onclick="toggleReviewForm()" style="flex: 1; padding: 12px; background: #ccc; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">Cancel</button>
        <button onclick="submitReview()" style="flex: 2; padding: 12px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">Submit Review</button>
      </div>
    </div>
  </div>
</section>

<!-- Shop Call-to-Action -->
<section style="text-align: center; background: white; margin: 40px auto; max-width: 800px; padding: 60px 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
  <h2 style="color: #667eea; font-size: 2.5rem; margin-bottom: 20px;">üõçÔ∏è Browse Our Full Menu</h2>
  <p style="font-size: 1.3rem; color: #666; margin-bottom: 30px; line-height: 1.6;">
    Discover our complete range of artisan baked goods, from signature shortbreads to custom celebration cakes.
  </p>
  <a href="shop.html" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px 40px; border-radius: 30px; text-decoration: none; font-size: 1.2rem; font-weight: bold; display: inline-block; transition: transform 0.3s; box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);">
    Visit Our Shop ‚Üí
  </a>
</section>

<!-- Move Market Section here, after cart -->
<section id="market">
  <h2>üé™ Highworth Market</h2>
  <div style="text-align: center; margin-bottom: 30px;">
    <p style="font-size: 1.3rem; font-weight: bold; color: #667eea;">Every Saturday ‚Ä¢ 8am - 2pm</p>
    <p style="font-size: 1.1rem; margin-top: 10px; color: #666;">Come visit us for fresh bakes, friendly chats, and our famous Shortbread Delight!</p>
  </div>

  <button class="market-toggle" id="marketToggle">See This Week's Bakes</button>

  <div class="market-bakes" id="marketBakes">
    <div class="products-grid">
      <div class="product-tile">
        <img src="pictures/thisweekshort.jpg" alt="Shortbread Delight">
        <div class="product-overlay">
          <div>
            <div class="product-title">Famous Shortbread Delight ‚≠ê</div>
            <div class="product-description">Our signature buttery shortbread - the star of the market!</div>
          </div>
        </div>
      </div>

      <div class="product-tile">
        <img src="pictures/christmascake.jpg" alt="Brownies">
        <div class="product-overlay">
          <div>
            <div class="product-title">Sliced Christmas cake</div>
            <div class="product-description">Rich and moist, perfect for the festive season.</div>
          </div>
        </div>
      </div>

      <div class="product-tile">
        <img src="pictures/caramelised.jpg" alt="Cupcakes">
        <div class="product-overlay">
          <div>
            <div class="product-title">Caramelised biscuit (Biscoff-style) brownies</div>
            <div class="product-description">Decadent brownies with a caramelised biscuit twist.</div>
          </div>
        </div>
      </div>

      <div class="product-tile">
        <img src="pictures/thisweekiced.jpg" alt="Biscuits">
        <div class="product-overlay">
          <div>
            <div class="product-title">Biscuit Selection</div>
            <div class="product-description">Handmade biscuits perfect for a cosy treat.</div>
          </div>
        </div>
      </div>

      <div class="product-tile">
        <img src="pictures/slicedvanilla.jpg" alt="New Market Bake">
        <div class="product-overlay">
          <div>
            <div class="product-title">Weekly Special</div>
            <div class="product-description">Vanilla sponge with apricot jam ‚Äî fondant or buttercream topping</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="social-links">
    <p style="font-size: 1.2rem; color: #667eea; font-weight: bold;">Follow us for weekly bakes & updates! üç™</p>
    <div class="social-icons">
      <a href="https://instagram.com/cupcakesontheavenue" target="_blank">
        <img src="pictures/instagram.png" alt="Instagram" width="45" height="45">
      </a>
      <a href="https://www.facebook.com/profile.php?id=61578246007533" target="_blank">
        <svg width="45" height="45" viewBox="0 0 24 24" fill="#1877F2">
          <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
        </svg>
      </a>
      <a href="https://tiktok.com/@Cupcakesontheheaven" target="_blank">
        <img src="pictures/tiktok.png" alt="TikTok" width="45" height="45">
      </a>
    </div>
  </div>
</section>

<div class="calendar-overlay" id="calendarOverlay"></div>
<div class="calendar-popup" id="calendarPopup">
  <button class="close-calendar" id="closeCalendar">√ó</button>
  <div class="calendar-nav">
    <button id="prevMonth">‚óÄ</button>
    <span id="monthYear"></span>
    <button id="nextMonth">‚ñ∂</button>
  </div>
  <div id="calendar"></div>
</div>

<section id="special-request">
  <h2>üíå Special Request</h2>
  <p style="text-align: center; margin-bottom: 25px; color: #666; font-size: 1.1rem;">
    Have a custom order or special requirement? Let us know!
  </p>
  <form id="specialForm">
    <input type="text" id="srName" name="srName" placeholder="Your Name *" autocomplete="name" required>
    <input type="email" id="srEmail" name="srEmail" placeholder="Your Email *" autocomplete="email" required>
    <textarea id="srMessage" name="srMessage" rows="5" placeholder="Describe your special request... *" required></textarea>
    <button type="submit">Send Request</button>
  </form>
</section>

<div id="toast"></div>

<footer class="site-footer">
  <nav>
    <a href="terms.html" target="_blank" rel="noopener">Terms & Conditions</a>
    <a href="privacy.html" target="_blank" rel="noopener">Privacy Policy</a>
    <a href="refunds.html" target="_blank" rel="noopener">Refunds & Cancellations</a>
    <a href="delivery.html" target="_blank" rel="noopener">Delivery & Collection</a>
  </nav>
  <p>¬© Cupcakes on the Avenue</p>
  <img src="pictures\food hygiene.jpg"" alt="Cupcake illustration" style="width: 80px; margin-top: 12px; opacity: 0.8;">
</footer>

<script>
// ‚úÖ SIMPLIFIED: Just the essentials for checkout
const BACKEND_BASE = 'https://sumup-backend.vercel.app';

let cart = JSON.parse(localStorage.getItem('cart') || '[]');
let currentMonth = new Date().getMonth();
let currentYear = new Date().getFullYear();
let blockedDates = JSON.parse(localStorage.getItem('blockedDates') || '[]');

// Initialize on page load
  document.addEventListener('DOMContentLoaded', function() {
    updateCart();
    initializeEventListeners();
    applySeason();
    updateStickyCart();
    loadRecentlyViewed();
  });

  function initializeEventListeners() {
  // Add to cart buttons
  document.querySelectorAll('.add-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const selectEl = document.querySelector(`.product-select[data-id="${this.dataset.id}"]`);
      if (!selectEl || !selectEl.value) {
        showToast('‚ö†Ô∏è Please select a size first');
        return;
      }
      
      const [variant, price] = selectEl.value.split('|');
      const productName = this.dataset.name;
      const fullName = `${productName} (${variant})`;
      
      addToCart(fullName, parseFloat(price));
      if (typeof trackAddToCart === 'function') {
        trackAddToCart(fullName, parseFloat(price));
      }
    });
  });

  // Calendar events
  const deliveryDateEl = document.getElementById('deliveryDate');
  if (deliveryDateEl) {
    deliveryDateEl.addEventListener('click', openCalendar);
  }
  
  const closeCalendarEl = document.getElementById('closeCalendar');
  if (closeCalendarEl) {
    closeCalendarEl.addEventListener('click', closeCalendar);
  }
  
  const calendarOverlayEl = document.getElementById('calendarOverlay');
  if (calendarOverlayEl) {
    calendarOverlayEl.addEventListener('click', closeCalendar);
  }
  
  const prevMonthEl = document.getElementById('prevMonth');
  if (prevMonthEl) {
    prevMonthEl.addEventListener('click', () => changeMonth(-1));
  }
  
  const nextMonthEl = document.getElementById('nextMonth');
  if (nextMonthEl) {
    nextMonthEl.addEventListener('click', () => changeMonth(1));
  }

  // Lead time warning
  const leadTimeNoEl = document.getElementById('leadTimeNo');
  if (leadTimeNoEl) {
    leadTimeNoEl.addEventListener('change', function() {
      const warningEl = document.getElementById('leadTimeWarning');
      if (warningEl) {
        warningEl.style.display = this.checked ? 'block' : 'none';
      }
    });
  }

  const leadTimeYesEl = document.getElementById('leadTimeYes');
  if (leadTimeYesEl) {
    leadTimeYesEl.addEventListener('change', function() {
      const warningEl = document.getElementById('leadTimeWarning');
      if (warningEl) {
        warningEl.style.display = 'none';
      }
    });
  }

  // Market toggle
  const marketToggleEl = document.getElementById('marketToggle');
  if (marketToggleEl) {
    marketToggleEl.addEventListener('click', function() {
      const bakes = document.getElementById('marketBakes');
      if (bakes) {
        bakes.classList.toggle('show');
        this.textContent = bakes.classList.contains('show') ? 'Hide Market Bakes' : 'See This Week\'s Bakes';
      }
    });
  }

  // Special request form
  const specialFormEl = document.getElementById('specialForm');
  if (specialFormEl) {
    specialFormEl.addEventListener('submit', function(e) {
      e.preventDefault();
      const nameEl = document.getElementById('srName');
      const emailEl = document.getElementById('srEmail');
      const messageEl = document.getElementById('srMessage');
      
      if (nameEl && emailEl && messageEl) {
        const name = nameEl.value;
        const email = emailEl.value;
        const message = messageEl.value;
        
        showToast('‚úÖ Request received! We\'ll contact you manually to discuss.');
        this.reset();
      }
    });
  }

  // Place Order Button - THE MAIN FIX
  const placeOrderBtn = document.getElementById('placeOrderBtn');
  if (placeOrderBtn) {
    placeOrderBtn.addEventListener('click', handlePlaceOrder);
  }
}

function addToCart(name, price) {
  const existing = cart.find(i => i.name === name);
  if (existing) {
    existing.quantity++;
  } else {
    cart.push({ name, price, quantity: 1 });
  }
  localStorage.setItem('cart', JSON.stringify(cart));
  updateCart();
  updateStickyCart();
  showToast(`‚úÖ ${name} added to cart!`);
}

function updateCart() {
  const contents = document.getElementById('cartContents');
  const itemCountEl = document.getElementById('itemCount');
  const cartTotalEl = document.getElementById('cartTotal');
  const orderEl = document.getElementById('order');
  
  if (!contents || !itemCountEl || !cartTotalEl || !orderEl) return;
  
  const total = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0);
  
  itemCountEl.textContent = `${cart.length} items`;
  cartTotalEl.textContent = `¬£${total.toFixed(2)}`;
  
  if (cart.length === 0) {
    contents.innerHTML = '<p style="text-align: center; color: #999; padding: 30px;">Your cart is empty</p>';
    orderEl.style.display = 'none';
  } else {
    orderEl.style.display = 'block';
    contents.innerHTML = `<ul>${cart.map((item, idx) => `
      <li>
        <div>
          <strong>${item.name}</strong><br>
          <span style="color: #666;">¬£${item.price.toFixed(2)} √ó ${item.quantity} = ¬£${(item.price * item.quantity).toFixed(2)}</span>
        </div>
        <div class="cart-controls">
          <button class="cart-btn" onclick="changeQuantity(${idx}, -1)">-</button>
          <span style="min-width: 30px; text-align: center;">${item.quantity}</span>
          <button class="cart-btn" onclick="changeQuantity(${idx}, 1)">+</button>
          <button class="cart-btn" onclick="removeFromCart(${idx})" style="color: #dc3545; border-color: #dc3545;">√ó</button>
        </div>
      </li>
    `).join('')}</ul>`;
  }
}

function changeQuantity(index, delta) {
  if (cart[index]) {
    cart[index].quantity += delta;
    if (cart[index].quantity <= 0) {
      cart.splice(index, 1);
    }
    localStorage.setItem('cart', JSON.stringify(cart));
    updateCart();
    updateStickyCart();
  }
}

function removeFromCart(index) {
  cart.splice(index, 1);
  localStorage.setItem('cart', JSON.stringify(cart));
  updateCart();
  updateStickyCart();
}

function updateStickyCart() {
  const stickyCart = document.getElementById('stickyCart');
  const countEl = document.getElementById('stickyCartCount');
  const totalEl = document.getElementById('stickyCartTotal');
  
  if (!stickyCart || !countEl || !totalEl) return;
  
  const total = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0);
  const itemCount = cart.reduce((sum, i) => sum + i.quantity, 0);
  
  countEl.textContent = `${itemCount} item${itemCount !== 1 ? 's' : ''}`;
  totalEl.textContent = `¬£${total.toFixed(2)}`;
  
  if (itemCount > 0) {
    stickyCart.classList.add('show');
  } else {
    stickyCart.classList.remove('show');
  }
}

function scrollToCart() {
  const cartSection = document.getElementById('order');
  if (cartSection) {
    cartSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    // Add a highlight animation
    cartSection.style.animation = 'cartHighlight 1s ease-in-out';
    setTimeout(() => {
      cartSection.style.animation = '';
    }, 1000);
  }
}

// Review form functions
function toggleReviewForm() {
  const form = document.getElementById('reviewForm');
  form.classList.toggle('active');
}

// Load reviews from backend
async function loadReviews() {
  try {
    const response = await fetch('https://sumup-backend.vercel.app/api/reviews');
    
    if (!response.ok) {
      throw new Error('Failed to load reviews');
    }
    
    const data = await response.json();
    displayReviews(data.reviews || []);
  } catch (error) {
    console.error('Error loading reviews:', error);
    document.getElementById('reviewsContainer').innerHTML = `
      <div style="text-align: center; padding: 30px; color: #666;">
        <p>Unable to load reviews. Showing sample reviews:</p>
      </div>
      <div class="review-card">
        <div class="review-header">
          <div>
            <span class="reviewer-name">Sarah M.</span>
            <span class="verified-badge">‚úì Verified Purchase</span>
          </div>
          <span class="review-date">2 days ago</span>
        </div>
        <div class="review-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
        <div class="review-text">
          "The Shortbread Delight is absolutely incredible! Best shortbread I've ever had. Buttery, crumbly perfection. I ordered for a party and everyone was asking where I got them. Will definitely order again!"
        </div>
      </div>
      <div class="review-card">
        <div class="review-header">
          <div>
            <span class="reviewer-name">James P.</span>
            <span class="verified-badge">‚úì Verified Purchase</span>
          </div>
          <span class="review-date">1 week ago</span>
        </div>
        <div class="review-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
        <div class="review-text">
          "Ordered a Christmas cake for our family celebration. The royal icing was beautiful and the cake was moist and delicious. Great communication and delivery was on time. Highly recommend!"
        </div>
      </div>
    `;
  }
}

function displayReviews(reviews) {
  const container = document.getElementById('reviewsContainer');
  
  if (reviews.length === 0) {
    container.innerHTML = '<p style="text-align: center; color: #666; padding: 30px;">No reviews yet. Be the first to leave a review!</p>';
    return;
  }
  
  container.innerHTML = reviews.map(review => {
    const stars = '‚òÖ'.repeat(review.rating) + '‚òÜ'.repeat(5 - review.rating);
    const date = new Date(review.createdAt).toLocaleDateString('en-GB', { 
      day: 'numeric', 
      month: 'short', 
      year: 'numeric' 
    });
    
    return `
      <div class="review-card">
        <div class="review-header">
          <div>
            <span class="reviewer-name">${escapeHtml(review.name)}</span>
            ${review.verified ? '<span class="verified-badge">‚úì Verified Purchase</span>' : ''}
          </div>
          <span class="review-date">${date}</span>
        </div>
        <div class="review-stars">${stars}</div>
        ${review.product ? `<div style="color: #667eea; font-size: 13px; margin: 5px 0; font-weight: 600;">${escapeHtml(review.product)}</div>` : ''}
        <div class="review-text">
          "${escapeHtml(review.reviewText)}"
        </div>
      </div>
    `;
  }).join('');
}

function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

async function submitReview() {
  const rating = document.querySelector('input[name="rating"]:checked');
  const name = document.getElementById('reviewName').value.trim();
  const email = document.getElementById('reviewEmail').value.trim();
  const product = document.getElementById('reviewProduct').value;
  const reviewText = document.getElementById('reviewText').value.trim();

  if (!rating || !name || !email || !reviewText) {
    alert('Please fill in all required fields including your star rating!');
    return;
  }

  // Email validation
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if (!emailRegex.test(email)) {
    alert('Please enter a valid email address!');
    return;
  }

  const submitButton = event.target;
  submitButton.disabled = true;
  submitButton.textContent = 'Submitting...';

  try {
    const response = await fetch('https://sumup-backend.vercel.app/api/reviews', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        rating: parseInt(rating.value),
        name,
        email,
        product: product || null,
        reviewText
      })
    });

    if (!response.ok) {
      throw new Error('Failed to submit review');
    }

    const data = await response.json();
    
    alert('Thank you for your review! It will be published after verification. üåü');
    toggleReviewForm();
    
    // Reset form
    document.getElementById('reviewName').value = '';
    document.getElementById('reviewEmail').value = '';
    document.getElementById('reviewProduct').value = '';
    document.getElementById('reviewText').value = '';
    document.querySelectorAll('input[name="rating"]').forEach(input => input.checked = false);
    
    // Reload reviews
    loadReviews();
  } catch (error) {
    console.error('Error submitting review:', error);
    alert('Failed to submit review. Please try again later.');
  } finally {
    submitButton.disabled = false;
    submitButton.textContent = 'Submit Review';
  }
}

// Load reviews when page loads
document.addEventListener('DOMContentLoaded', () => {
  loadReviews();
  startLiveUpdates();
});

// ========================================
// Live Notifications System
// ========================================

let pollData = null;
let userVote = null;

function startLiveUpdates() {
  // Poll for live updates every 5 seconds
  setInterval(checkForLiveUpdates, 5000);
  
  // Check immediately on load
  checkForLiveUpdates();
}

async function checkForLiveUpdates() {
  try {
    const response = await fetch('https://sumup-backend.vercel.app/api/live-status');
    
    if (!response.ok) {
      console.error('Live status request failed:', response.status);
      return;
    }
    
    const data = await response.json();
    console.log('Live status update:', data);
    
    // Update market status
    if (data.marketStatus) {
      console.log('Updating market status:', data.marketStatus);
      updateMarketStatus(data.marketStatus);
    } else {
      // Clear market banner if no status
      const banner = document.querySelector('.market-status-banner');
      if (banner) banner.remove();
    }
    
    // Show announcement if new (use timestamp instead of id)
    if (data.announcement) {
      const lastTimestamp = localStorage.getItem('lastAnnouncementTimestamp');
      const currentTimestamp = data.announcement.timestamp;
      
      if (!lastTimestamp || currentTimestamp !== lastTimestamp) {
        console.log('Showing announcement:', data.announcement.message);
        showAnnouncement(data.announcement);
        localStorage.setItem('lastAnnouncementTimestamp', currentTimestamp);
      }
    }
    
    // Update poll if active
    if (data.poll && data.poll.active) {
      console.log('Updating poll:', data.poll);
      updatePoll(data.poll);
    } else {
      closePoll();
    }
    
  } catch (error) {
    console.error('Failed to check live updates:', error);
  }
}

function showNotification(icon, title, message, type = '') {
  console.log('[Notification]', {icon, title, message, type});
  const notification = document.getElementById('liveNotification');
  const iconEl = document.getElementById('notificationIcon');
  const titleEl = document.getElementById('notificationTitle');
  const messageEl = document.getElementById('notificationMessage');
  
  if (!notification || !iconEl || !titleEl || !messageEl) {
    console.error('[Notification] Elements not found!');
    return;
  }
  
  // Reset classes
  notification.className = 'live-notification';
  if (type) {
    notification.classList.add(type);
  }
  
  // Set content
  iconEl.textContent = icon;
  titleEl.textContent = title;
  messageEl.textContent = message;
  
  // Show notification
  notification.classList.add('show');
  console.log('[Notification] Displayed! Will auto-hide in 8s');
  
  // Auto hide after 8 seconds
  setTimeout(() => {
    notification.classList.remove('show');
    console.log('[Notification] Hidden');
  }, 8000);
}

function updateMarketStatus(status) {
  console.log('[Market Status] Updating to:', status);
  const banner = document.getElementById('marketStatusBanner');
  const text = document.getElementById('marketStatusText');
  
  if (!banner || !text) {
    console.error('[Market Status] Banner elements not found!');
    return;
  }
  
  banner.className = 'market-status-banner';
  
  if (status === 'open') {
    banner.classList.add('open', 'show');
    text.innerHTML = 'üè™ <strong>WE\'RE OPEN!</strong> Come visit us at Highworth Market - Fresh bakes available now!';
    console.log('[Market Status] Banner set to OPEN');
    showNotification('üéâ', 'Market is OPEN!', 'Come visit us for fresh baked goods!', 'market-open');
  } else if (status === 'closed') {
    banner.classList.add('closed', 'show');
    text.innerHTML = 'üò¥ <strong>Market Closed</strong> - See you next Saturday 8am-2pm!';
    console.log('[Market Status] Banner set to CLOSED');
  } else {
    banner.classList.remove('show');
    console.log('[Market Status] Banner hidden');
  }
}

function showAnnouncement(announcement) {
  console.log('[Announcement] Showing:', announcement.message);
  showNotification('üì¢', 'Announcement', announcement.message, 'announcement');
  
  // Also create a persistent banner for important announcements
  if (announcement.important) {
    console.log('[Announcement] Important - adding to banner');
    const banner = document.getElementById('marketStatusBanner');
    banner.className = 'market-status-banner announcement show';
    document.getElementById('marketStatusText').innerHTML = `üì¢ <strong>${escapeHtml(announcement.message)}</strong>`;
  }
}

function updatePoll(poll) {
  const container = document.getElementById('pollContainer');
  const optionsEl = document.getElementById('pollOptions');
  
  // Save poll data
  pollData = poll;
  
  // Check if user already voted
  const savedVote = localStorage.getItem(`poll_${poll.id}_vote`);
  if (savedVote) {
    userVote = savedVote;
  }
  
  // Calculate total votes
  const totalVotes = poll.options.reduce((sum, opt) => sum + opt.votes, 0);
  
  // Build options HTML
  optionsEl.innerHTML = poll.options.map((option, index) => {
    const percentage = totalVotes > 0 ? (option.votes / totalVotes * 100).toFixed(1) : 0;
    const voted = userVote === option.text;
    
    return `
      <div class="poll-option ${voted ? 'voted' : ''}" onclick="votePoll('${option.text}')">
        <div class="poll-option-text">${escapeHtml(option.text)}</div>
        <div class="poll-votes">${option.votes} vote${option.votes !== 1 ? 's' : ''} (${percentage}%)</div>
        <div class="poll-progress" style="width: ${percentage}%"></div>
      </div>
    `;
  }).join('');
  
  // Show container
  container.classList.add('show');
  
  // Show notification if poll is new
  const lastPollId = localStorage.getItem('lastPollId');
  if (lastPollId !== poll.id) {
    showNotification('üç∞', 'New Poll!', `Vote for: ${poll.question || 'Next Flavor'}`, 'poll');
    localStorage.setItem('lastPollId', poll.id);
  }
}

async function votePoll(option) {
  if (!pollData) return;
  
  // Don't allow voting twice
  if (userVote) {
    alert('You\'ve already voted in this poll!');
    return;
  }
  
  try {
    const response = await fetch('https://sumup-backend.vercel.app/api/live-status', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        action: 'vote',
        data: { option: option }
      })
    });
    
    if (!response.ok) throw new Error('Vote failed');
    
    // Save vote locally
    userVote = option;
    localStorage.setItem(`poll_${pollData.id}_vote`, option);
    
    // Refresh poll data
    checkForLiveUpdates();
    
    showNotification('‚úÖ', 'Vote Recorded!', `You voted for ${option}`, 'poll');
    
  } catch (error) {
    console.error('Failed to vote:', error);
    alert('Failed to record vote. Please try again.');
  }
}

function closePoll() {
  const container = document.getElementById('pollContainer');
  container.classList.remove('show');
}

// ‚úÖ SIMPLIFIED CHECKOUT FUNCTION - Uses backend API for Discord & Stripe
async function handlePlaceOrder() {
  console.log('üöÄ Starting checkout process...');
  
  // Get form elements
  const nameEl = document.getElementById('customerName');
  const emailEl = document.getElementById('customerEmail');
  const mobileEl = document.getElementById('customerMobile');
  const addressEl = document.getElementById('customerAddress');
  const notesEl = document.getElementById('customerNotes');
  const deliveryEl = document.getElementById('deliveryMethod');
  const dateEl = document.getElementById('deliveryDate');
  const privacyEl = document.getElementById('privacyCheck');
  const termsEl = document.getElementById('termsCheck');
  const orderBtn = document.getElementById('placeOrderBtn');

  if (!nameEl || !emailEl || !mobileEl || !addressEl || !deliveryEl || !dateEl || !privacyEl || !termsEl || !orderBtn) {
    showToast('‚ö†Ô∏è Form elements not found. Please refresh the page.');
    return;
  }

  // Get form values
  const name = nameEl.value.trim();
  const email = emailEl.value.trim();
  const mobile = mobileEl.value.trim();
  const address = addressEl.value.trim();
  const delivery = deliveryEl.value;
  const date = dateEl.value;
  const notes = notesEl.value.trim();
  const privacy = privacyEl.checked;
  const terms = termsEl.checked;

  // Basic validation
  if (!name || !email || !mobile || !address || !delivery || !date) {
    showToast('‚ö†Ô∏è Please fill all required fields');
    return;
  }

  if (!/^[0-9]{11}$/.test(mobile)) {
    showToast('‚ö†Ô∏è Please enter a valid 11-digit UK mobile number');
    return;
  }

  if (!privacy || !terms) {
    showToast('‚ö†Ô∏è Please accept Privacy Policy and Terms');
    return;
  }

  if (cart.length === 0) {
    showToast('‚ö†Ô∏è Your cart is empty');
    return;
  }

  // Disable button and show processing
  orderBtn.disabled = true;
  orderBtn.textContent = 'Processing Order...';

  try {
    // Calculate total and create order reference
    const total = cart.reduce((s, i) => s + i.price * i.quantity, 0);
    const orderReference = 'ORDER-' + Date.now();
    
    // Get delivery method label
    const deliveryMethod = delivery === 'collect' ? 'Collection' 
      : delivery === 'collect_market' ? 'Market Collection'
      : delivery === 'delivery' ? 'Delivery' : 'Delivery';

    // Create items string for Discord
    const itemsString = cart.map(item => `${item.name} x${item.quantity}`).join(', ');

    console.log('üì¶ Sending order to backend:', {
      reference: orderReference,
      total: total.toFixed(2),
      customer: name,
      items: itemsString
    });

    // ‚úÖ Send everything through your backend API
    orderBtn.textContent = 'Sending to Discord & Stripe...';
    
    const orderData = {
      reference: orderReference,        // Required
      total: total.toFixed(2),         // Required
      name: name,                      // Customer name
      email: email,                    // Email for manual contact (NO AUTO-EMAILS)
      phone: mobile,                   // Phone number (or use 'mobile')
      delivery: deliveryMethod,        // 'Delivery' or 'Collection'
      date: date,                      // Delivery/collection date
      address: address,                // Delivery address
      items: itemsString,              // What they ordered
      notes: notes || 'No special instructions' // Special instructions
    };

    const response = await fetch(`${BACKEND_BASE}/api/discord-webhook`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(orderData)
    });

    // ü§ñ Discord Admin Bot notifications now handled in backend automatically!

    console.log('üì° Backend response status:', response.status);

    if (response.ok) {
      const result = await response.json();
      console.log('‚úÖ Backend processed successfully:', result);
      
      // Clear cart
      cart = [];
      localStorage.setItem('cart', JSON.stringify(cart));
      updateCart();
      updateStickyCart();

      // Show success and redirect to Stripe
      showToast('‚úÖ Order sent! Redirecting to payment...');
      orderBtn.textContent = 'Redirecting to Stripe...';
      
      // If backend returns a Stripe URL, redirect to it
      if (result.stripeUrl) {
        console.log('ÔøΩ Redirecting to Stripe:', result.stripeUrl);
        setTimeout(() => {
          window.location.href = result.stripeUrl;
        }, 1000);
      } else {
        // Fallback: redirect to checkout endpoint
        const checkoutUrl = `${BACKEND_BASE}/api/checkout?total=${total.toFixed(2)}&reference=${orderReference}`;
        console.log('ÔøΩ Redirecting to checkout:', checkoutUrl);
        setTimeout(() => {
          window.location.href = checkoutUrl;
        }, 1000);
      }
      
    } else {
      const errorText = await response.text();
      console.error('‚ùå Backend error:', errorText);
      throw new Error(`Backend returned ${response.status}: ${errorText}`);
    }

  } catch (error) {
    console.error('‚ùå Checkout failed:', error);
    showToast('‚ö†Ô∏è Checkout failed. Please try again or call us directly.');
    orderBtn.disabled = false;
    orderBtn.textContent = 'Place Order & Pay';
  }
}

// Calendar functions
function openCalendar() {
  const overlay = document.getElementById('calendarOverlay');
  const popup = document.getElementById('calendarPopup');
  if (overlay && popup) {
    overlay.style.display = 'block';
    popup.style.display = 'block';
    renderCalendar();
  }
}

function closeCalendar() {
  const overlay = document.getElementById('calendarOverlay');
  const popup = document.getElementById('calendarPopup');
  if (overlay && popup) {
    overlay.style.display = 'none';
    popup.style.display = 'none';
  }
}

function changeMonth(delta) {
  currentMonth += delta;
  if (currentMonth > 11) {
    currentMonth = 0;
    currentYear++;
  } else if (currentMonth < 0) {
    currentMonth = 11;
    currentYear--;
  }
  renderCalendar();
}

function renderCalendar() {
  const calendarEl = document.getElementById('calendar');
  const monthYearEl = document.getElementById('monthYear');
  
  if (!calendarEl || !monthYearEl) return;
  
  const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
  monthYearEl.textContent = `${monthNames[currentMonth]} ${currentYear}`;
  
  const firstDay = new Date(currentYear, currentMonth, 1).getDay();
  const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
  
  let html = '<table><thead><tr><th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th></tr></thead><tbody><tr>';
  
  const today = new Date();
  const minDate = new Date(today);
  minDate.setDate(today.getDate() + 7);
  
  for (let i = 0; i < firstDay; i++) {
    html += '<td></td>';
  }
  
  for (let day = 1; day <= daysInMonth; day++) {
    const date = new Date(currentYear, currentMonth, day);
    const dateStr = date.toISOString().split('T')[0];
    const dayOfWeek = date.getDay();
    const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
    const isBlocked = blockedDates.includes(dateStr);
    const isTooSoon = date < minDate;
    const disabled = isBlocked || isTooSoon;
    
    let className = '';
    if (disabled) className = 'disabled';
    else if (isWeekend) className = 'weekend';
    
    html += `<td class="${className}" ${!disabled ? `onclick="selectDate('${dateStr}')"` : ''}>${day}</td>`;
    
    if ((firstDay + day) % 7 === 0) {
      html += '</tr><tr>';
    }
  }
  
  html += '</tr></tbody></table>';
  calendarEl.innerHTML = html;
}

function selectDate(dateStr) {
  const dateEl = document.getElementById('deliveryDate');
  if (dateEl) {
    dateEl.value = dateStr;
    closeCalendar();
  }
}

function showToast(message) {
  const toast = document.getElementById('toast');
  if (toast) {
    toast.textContent = message;
    toast.classList.add('show');
    setTimeout(() => {
      toast.classList.remove('show');
    }, 3000);
  }
}

// Seasonal theme
function applySeason() {
  const month = new Date().getMonth();
  let season = '';
  
  if (month >= 2 && month <= 4) season = 'spring';
  else if (month >= 5 && month <= 7) season = 'summer';
  else if (month >= 8 && month <= 10) season = 'autumn';
  else season = 'winter';
  
  document.body.className = season;
}

// Christmas Light Switch-On Event Countdown Timer
function updateMarketCountdown() {
  const now = new Date();
  
  // Christmas Light Switch-On: Saturday, November 29, 2025 at 10:00 AM
  const eventDate = new Date('2025-11-29T10:00:00');
  
  const timeUntil = eventDate - now;
  
  // Check if event is happening now (within the event window)
  const eventEnd = new Date('2025-11-29T14:00:00'); // Assume event ends at 2pm
  if (now >= eventDate && now <= eventEnd) {
    // Event is happening NOW!
    document.getElementById('marketCountdown').innerHTML = `
      <div style="font-size: 1.5rem; font-weight: bold; animation: pulse 1.5s infinite;">
        ÔøΩ‚ú® EVENT IS HAPPENING NOW! ‚ú®ÔøΩ
      </div>
    `;
    return;
  }
  
  // Check if event has passed
  if (timeUntil < 0) {
    document.getElementById('marketCountdown').innerHTML = `
      <div style="font-size: 1.3rem; font-weight: bold; color: rgba(255,255,255,0.9);">
        Event has ended - See you next time! üéÑ
      </div>
    `;
    return;
  }
  
  const days = Math.floor(timeUntil / (1000 * 60 * 60 * 24));
  const hours = Math.floor((timeUntil % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  const minutes = Math.floor((timeUntil % (1000 * 60 * 60)) / (1000 * 60));
  const seconds = Math.floor((timeUntil % (1000 * 60)) / 1000);
  
  document.getElementById('days').textContent = days.toString().padStart(2, '0');
  document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
  document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
  document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
}

// Start countdown timer
setInterval(updateMarketCountdown, 1000);
updateMarketCountdown(); // Initial call

function loadRecentlyViewed() {
  // Placeholder for recently viewed items functionality
  console.log('üìñ Recently viewed items loaded');
}

// Make functions globally accessible
window.changeQuantity = changeQuantity;
window.removeFromCart = removeFromCart;
window.selectDate = selectDate;
</script>

<!-- Discord Live Chat Widget -->
<link rel="stylesheet" href="discord-chat.css">
<script src="discord-chat.js"></script>
<script>
  // Initialize Discord chat widget after everything loads
  window.addEventListener('load', function() {
    // Prevent double initialization
    if (window.discordChat) {
      console.log('‚ö†Ô∏è Chat widget already initialized, skipping...');
      return;
    }
    
    console.log('üßÅ Initializing chat widget...');
    try {
      if (typeof DiscordChatWidget === 'undefined') {
        console.error('‚ùå DiscordChatWidget class not found. Check if discord-chat.js is loaded.');
        return;
      }
      
      window.discordChat = new DiscordChatWidget({
        webhookUrl: 'https://discord.com/api/webhooks/1441917103153090671/KNupEAUqkfz0orXHbo31YH7_0ZmV8cIprHZr8rNFn1nDNfA-UUijrfUSPnzV7IYcKErB',
        businessName: 'Cupcakes on the Avenue'
      });
      console.log('‚úÖ Chat widget initialized successfully!');
    } catch (error) {
      console.error('‚ùå Error initializing chat widget:', error);
    }
  });
</script>

</body>
</html>
