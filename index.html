<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Cupcakes on the Avenue</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  color: #333;
}

/* Header */
header {
  background: rgba(255, 255, 255, 0.95);
  padding: 20px;
  text-align: center;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

header h1 {
  color: #667eea;
  font-size: 2.5rem;
  margin-bottom: 10px;
}

header p {
  color: #666;
  font-size: 1.1rem;
  margin-bottom: 15px;
}

nav a {
  color: #667eea;
  text-decoration: none;
  margin: 0 15px;
  font-weight: 600;
  transition: color 0.3s;
}

nav a:hover {
  color: #764ba2;
}

/* Hero */
.hero {
  text-align: center;
  padding: 60px 20px;
  color: white;
}

.hero img {
  max-width: 300px;
  border-radius: 15px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  margin-bottom: 20px;
}

.hero h2 {
  font-size: 2.5rem;
  margin-bottom: 10px;
}

.hero p {
  font-size: 1.3rem;
  opacity: 0.9;
}

/* Sections */
section {
  max-width: 1400px;
  margin: 40px auto;
  padding: 40px 20px;
  background: white;
  border-radius: 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
}

section h2 {
  text-align: center;
  font-size: 2.5rem;
  color: #667eea;
  margin-bottom: 40px;
}

/* Product Tiles */
.products-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 30px;
}

.product-tile {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 15px;
  overflow: hidden;
  cursor: pointer;
  transition: transform 0.3s, box-shadow 0.3s;
  position: relative;
  height: 350px;
}

.product-tile:hover {
  transform: translateY(-10px);
  box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
}

.product-tile img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.product-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.95);
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: 25px;
  opacity: 0;
  transition: opacity 0.3s;
}

.product-tile:hover .product-overlay {
  opacity: 1;
}

.product-title {
  font-size: 1.5rem;
  font-weight: bold;
  color: #667eea;
  margin-bottom: 10px;
}

.product-description {
  color: #666;
  font-size: 1rem;
  line-height: 1.5;
  flex: 1;
}

.product-select {
  width: 100%;
  padding: 12px;
  border: 2px solid #667eea;
  border-radius: 8px;
  font-size: 1rem;
  margin-bottom: 10px;
  background: white;
}

.add-btn {
  width: 100%;
  padding: 14px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 1.1rem;
  font-weight: bold;
  cursor: pointer;
  transition: transform 0.2s;
}

.add-btn:hover {
  transform: scale(1.05);
}

/* Cart */
.cart-section {
  max-width: 800px;
  margin: 40px auto;
  background: white;
  border-radius: 20px;
  padding: 30px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
}

.cart-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
  padding-bottom: 20px;
  border-bottom: 2px solid #f0f0f0;
}

.cart-header h2 {
  color: #667eea;
  margin: 0;
}

#itemCount {
  background: #667eea;
  color: white;
  padding: 8px 15px;
  border-radius: 20px;
  font-weight: bold;
}

.cart-items ul {
  list-style: none;
}

.cart-items li {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px;
  margin-bottom: 10px;
  background: #f8f9fa;
  border-radius: 10px;
}

.cart-controls {
  display: flex;
  gap: 10px;
}

.cart-btn {
  width: 35px;
  height: 35px;
  border: 2px solid #667eea;
  background: white;
  color: #667eea;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.2s;
}

.cart-btn:hover {
  background: #667eea;
  color: white;
}

.cart-total {
  display: flex;
  justify-content: space-between;
  padding: 20px;
  background: #f8f9fa;
  border-radius: 10px;
  font-size: 1.5rem;
  font-weight: bold;
  color: #667eea;
  margin-top: 20px;
}

.customer-form input,
.customer-form select,
.customer-form textarea {
  width: 100%;
  padding: 12px;
  margin: 10px 0;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 1rem;
}

.customer-form input:focus,
.customer-form select:focus {
  border-color: #667eea;
  outline: none;
}

.checkbox-group {
  margin: 15px 0;
}

.checkbox-group label {
  display: flex;
  align-items: center;
  margin: 8px 0;
  cursor: pointer;
}

.checkbox-group input[type="checkbox"] {
  width: auto;
  margin-right: 10px;
}

.order-btn {
  width: 100%;
  padding: 18px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.2rem;
  font-weight: bold;
  cursor: pointer;
  margin-top: 20px;
  transition: transform 0.2s;
}

.order-btn:hover {
  transform: scale(1.02);
}

/* Calendar */
.calendar-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.7);
  z-index: 999;
}

.calendar-popup {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  padding: 30px;
  border-radius: 15px;
  box-shadow: 0 10px 50px rgba(0,0,0,0.3);
  z-index: 1000;
  max-width: 400px;
  width: 90%;
}

.calendar-nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.calendar-nav button {
  background: #667eea;
  color: white;
  border: none;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
}

.calendar-nav span {
  font-size: 1.2rem;
  font-weight: bold;
  color: #667eea;
}

#calendar table {
  width: 100%;
  border-collapse: collapse;
}

#calendar th,
#calendar td {
  padding: 10px;
  text-align: center;
  border: 1px solid #e0e0e0;
}

#calendar th {
  background: #667eea;
  color: white;
  font-weight: bold;
}

#calendar td {
  cursor: pointer;
  transition: background 0.2s;
}

#calendar td:hover:not(.disabled) {
  background: #e8eaf6;
}

#calendar td.disabled {
  color: #ccc;
  cursor: not-allowed;
  background: #f5f5f5;
}

#calendar td.weekend {
  background: #fff3e0;
}

.close-calendar {
  position: absolute;
  top: 10px;
  right: 15px;
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #667eea;
}

/* Toast */
#toast {
  visibility: hidden;
  min-width: 300px;
  background: #667eea;
  color: white;
  text-align: center;
  border-radius: 10px;
  padding: 16px;
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10000;
  font-size: 1rem;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
  opacity: 0;
  transition: opacity 0.3s, visibility 0.3s;
}

#toast.show {
  visibility: visible;
  opacity: 1;
}

/* Snowflakes */
.snowflake {
  position: fixed;
  top: -10vh;
  color: white;
  font-size: 20px;
  pointer-events: none;
  z-index: 10000;
  animation: fall linear infinite, sway ease-in-out infinite;
}

@keyframes fall {
  to { transform: translateY(120vh); }
}

@keyframes sway {
  0%, 100% { margin-left: 0; }
  50% { margin-left: 50px; }
}

/* Market Section */
.market-toggle {
  display: block;
  margin: 0 auto 30px;
  padding: 15px 40px;
  background: #667eea;
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.2rem;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.3s;
}

.market-toggle:hover {
  background: #764ba2;
}

.market-bakes {
  display: none;
}

.market-bakes.show {
  display: block;
}

.social-links {
  text-align: center;
  margin-top: 30px;
}

.social-icons {
  display: flex;
  gap: 20px;
  justify-content: center;
  margin-top: 15px;
}

.social-icons a {
  transition: transform 0.2s;
}

.social-icons a:hover {
  transform: scale(1.2);
}

/* Footer */
footer {
  background: white;
  text-align: center;
  padding: 40px 20px;
  margin-top: 60px;
  box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
}

footer img {
  max-width: 200px;
  margin-top: 20px;
  border-radius: 10px;
}

/* Special Request */
#special-request form input,
#special-request form textarea {
  width: 100%;
  padding: 12px;
  margin: 10px 0;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 1rem;
}

#special-request form button {
  width: 100%;
  padding: 15px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.1rem;
  font-weight: bold;
  cursor: pointer;
  margin-top: 10px;
}

/* New lead time section styles */
.leadtime-group {
  margin: 15px 0;
  padding: 12px;
  background: #f8f9fa;
  border-radius: 10px;
  border: 1px solid #e0e0e0;
}

.leadtime-group p {
  margin-bottom: 8px;
  color: #444;
  font-weight: 600;
}

.leadtime-group label {
  margin-right: 15px;
  font-weight: 500;
}

.leadtime-note {
  margin-top: 8px;
  color: #b45309; /* amber */
  background: #fffbeb;
  border: 1px solid #fde68a;
  padding: 8px 10px;
  border-radius: 8px;
}

@media (max-width: 768px) {
  .products-grid {
    grid-template-columns: 1fr;
  }
  
  header h1 {
    font-size: 2rem;
  }
  
  .hero h2 {
    font-size: 2rem;
  }
}
</style>
</head>
<body>

<header>
  <h1>üßÅ Cupcakes on the Avenue</h1>
  <p>Home of the exclusive Shortbread Delight & cosy bakes!</p>
  <nav>
    <a href="#about">About</a>
    <a href="#festive">Festive Bakes</a>
    <a href="#shop">Regular Shop</a>
    <a href="#market">Market</a>
    <a href="#order">Order</a>
  </nav>
</header>

<div class="hero">
  <img src="pictures/logo.png" alt="Cupcakes on the Avenue">
  <h2>Where every bake feels like home</h2>
  <p>Fresh cupcakes, biscuits, and celebration cakes baked with love!</p>
</div>

<section id="about">
  <h2>About Us</h2>
  <p style="text-align: center; font-size: 1.2rem; line-height: 1.8; max-width: 800px; margin: 0 auto; color: #666;">
    At Cupcakes on the Avenue, every bake feels like home. From our exclusive Shortbread Delight to cupcakes, biscuits, and cakes made for celebrating, everything is baked with love and a sprinkle of fun. Find us at Highworth Market every Saturday or order online for custom treats.
  </p>
</section>

<section id="festive">
  <h2>üéÑ Festive Bakes</h2>
  <div class="products-grid" style="justify-items: center;">
    
    <div class="product-tile">
      <img src="pictures/marzipan.jpg" alt="Christmas Cake">
      <div class="product-overlay">
        <div>
          <div class="product-title">Christmas Cake with Royal Icing</div>
          <div class="product-description">Traditional Christmas cake with elegant royal icing. Available with or without alcohol.</div>
        </div>
        <div>
          <select class="product-select" data-id="festive-1">
            <option value="6 inch|30">6 inch - ¬£30</option>
            <option value="8 inch|40">8 inch - ¬£40</option>
          </select>
          <button class="add-btn" data-name="Christmas Cake - Royal Icing" data-id="festive-1">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="product-tile">
      <img src="pictures/fondant.jpg" alt="Marzipan Cake">
      <div class="product-overlay">
        <div>
          <div class="product-title">Christmas Cake with Marzipan</div>
          <div class="product-description">Rich fruit cake with marzipan and fondant icing. With or without alcohol.</div>
        </div>
        <div>
          <select class="product-select" data-id="festive-2">
            <option value="6 inch|30">6 inch - ¬£30</option>
            <option value="8 inch|40">8 inch - ¬£40</option>
          </select>
          <button class="add-btn" data-name="Christmas Cake - Marzipan" data-id="festive-2">Add to Cart</button>
        </div>
      </div>
    </div>

  </div>
</section>

<section id="shop">
  <h2>üç™ Regular Shop</h2>
  <div class="products-grid">

    <div class="product-tile">
      <img src="pictures/shortbread.jpg" alt="Shortbread">
      <div class="product-overlay">
        <div>
          <div class="product-title">Exclusive Shortbread Delight</div>
          <div class="product-description">Our signature buttery, melt-in-your-mouth shortbread. A customer favorite!</div>
        </div>
        <div>
          <select class="product-select" data-id="regular-1">
            <option value="6 inch|20">6 inch - ¬£20</option>
            <option value="8 inch|25">8 inch - ¬£25</option>
            <option value="10 inch|30">10 inch - ¬£30</option>
          </select>
          <button class="add-btn" data-name="Shortbread Delight" data-id="regular-1">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="product-tile">
      <img src="pictures/icedshortbread.jpg" alt="Iced Shortbread">
      <div class="product-overlay">
        <div>
          <div class="product-title">Iced Shortbread</div>
          <div class="product-description">Buttery shortbread topped with smooth icing. Perfect for special occasions!</div>
        </div>
        <div>
          <select class="product-select" data-id="regular-2">
            <option value="Pack of 10|10">Pack of 10 - ¬£10</option>
            <option value="Pack of 20|18">Pack of 20 - ¬£18</option>
          </select>
          <button class="add-btn" data-name="Iced Shortbread" data-id="regular-2">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="product-tile">
      <img src="pictures/ricecrispy.jpg" alt="Rice Crispy Treats">
      <div class="product-overlay">
        <div>
          <div class="product-title">Rice Crispy Treats</div>
          <div class="product-description">Classic marshmallow rice crispy treats. Light, crispy, and delicious!</div>
        </div>
        <div>
          <select class="product-select" data-id="regular-3">
            <option value="Pack of 6|10">Pack of 6 - ¬£10</option>
            <option value="Pack of 12|18">Pack of 12 - ¬£18</option>
          </select>
          <button class="add-btn" data-name="Rice Crispy Treats" data-id="regular-3">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="product-tile">
      <img src="pictures/cupcakes.jpg" alt="Cupcakes">
      <div class="product-overlay">
        <div>
          <div class="product-title">Cupcakes</div>
          <div class="product-description">Delicious cupcakes in various flavors. Choose from vanilla, chocolate, and seasonal specialties!</div>
        </div>
        <div>
          <select class="product-select" data-id="regular-4">
            <option value="Pack of 6|15">Pack of 6 - ¬£15</option>
            <option value="Pack of 12|28">Pack of 12 - ¬£28</option>
            <option value="Pack of 24|50">Pack of 24 - ¬£50</option>
          </select>
          <button class="add-btn" data-name="Cupcakes" data-id="regular-4">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="product-tile">
      <img src="pictures/purplecake.jpg" alt="Celebration Cake">
      <div class="product-overlay">
        <div>
          <div class="product-title">Custom Celebration Cake</div>
          <div class="product-description">Bespoke cakes for birthdays, weddings, and special occasions. Contact us for custom designs!</div>
        </div>
        <div>
          <select class="product-select" data-id="regular-5">
            <option value="6 inch|35">6 inch - ¬£35</option>
            <option value="8 inch|50">8 inch - ¬£50</option>
            <option value="10 inch|70">10 inch - ¬£70</option>
          </select>
          <button class="add-btn" data-name="Celebration Cake" data-id="regular-5">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="product-tile">
      <img src="pictures/sweettrimmings.jpg" alt="Sweet Trimming Pots">
      <div class="product-overlay">
        <div>
          <div class="product-title">Sweet Trimming Pots</div>
          <div class="product-description">Adorable individual dessert pots filled with cake, cream, and sweet trimmings. Perfect party treats!</div>
        </div>
        <div>
          <select class="product-select" data-id="regular-6">
            <option value="Single Pot|4">Single Pot - ¬£4</option>
            <option value="Pack of 6|22">Pack of 6 - ¬£22</option>
            <option value="Pack of 12|42">Pack of 12 - ¬£42</option>
          </select>
          <button class="add-btn" data-name="Sweet Trimming Pots" data-id="regular-6">Add to Cart</button>
        </div>
      </div>
    </div>

  </div>
</section>

<div id="order" class="cart-section">
  <div class="cart-header">
    <h2>üõí Your Cart</h2>
    <span id="itemCount">0 items</span>
  </div>

  <div class="cart-items" id="cartContents">
    <p style="text-align: center; color: #999; padding: 30px;">Your cart is empty</p>
  </div>

  <div class="cart-total">
    <span>Total:</span>
    <span id="cartTotal">¬£0.00</span>
  </div>

  <div class="customer-form">
    <h3 style="color: #667eea; margin: 25px 0 15px;">Customer Details</h3>
    <input type="text" id="customerName" placeholder="Full Name *" required>
    <input type="email" id="customerEmail" placeholder="Email Address *" required>
    <input type="tel" id="customerMobile" placeholder="Mobile Number *" required pattern="[0-9]{11}" title="Please enter an 11-digit UK mobile number">
    <input type="text" id="customerAddress" placeholder="Delivery Address *" required>
    <textarea id="customerNotes" rows="3" placeholder="Special Requests / Toppings (optional)"></textarea>

    <select id="deliveryMethod" required>
      <option value="">Select Delivery Method *</option>
      <option value="Delivery">Home Delivery</option>
      <option value="Collection">Collection from Market</option>
    </select>

    <input type="text" id="deliveryDate" placeholder="Click to select delivery date (min 7 days) *" readonly style="cursor: pointer;">

    <div class="leadtime-group">
      <p>Is your delivery date at least one week from today?</p>
      <label><input type="radio" name="leadTime" id="leadTimeYes" checked> Yes</label>
      <label><input type="radio" name="leadTime" id="leadTimeNo"> No</label>
      <p id="leadTimeWarning" class="leadtime-note" style="display:none;">
        Please call <a href="tel:07842817789">07842817789</a> to discuss if we can make it earlier.
      </p>
    </div>

    <div class="checkbox-group">
      <label>
        <input type="checkbox" id="privacyCheck" required>
        I agree to the Privacy Policy *
      </label>
      <label>
        <input type="checkbox" id="termsCheck" required>
        I agree to the Terms & Conditions *
      </label>
    </div>

    <button class="order-btn" id="placeOrderBtn">Place Order & Pay</button>
  </div>
</div>

<!-- Move Market Section here, after cart -->
<section id="market">
  <h2>üé™ Highworth Market</h2>
  <div style="text-align: center; margin-bottom: 30px;">
    <p style="font-size: 1.3rem; font-weight: bold; color: #667eea;">Every Saturday ‚Ä¢ 8am - 2pm</p>
    <p style="font-size: 1.1rem; margin-top: 10px; color: #666;">Come visit us for fresh bakes, friendly chats, and our famous Shortbread Delight!</p>
  </div>

  <button class="market-toggle" id="marketToggle">See This Week's Bakes</button>

  <div class="market-bakes" id="marketBakes">
    <div class="products-grid">
      <div class="product-tile">
        <img src="pictures/shortbread delight.jpg" alt="Shortbread Delight">
        <div class="product-overlay">
          <div>
            <div class="product-title">Famous Shortbread Delight ‚≠ê</div>
            <div class="product-description">Our signature buttery shortbread - the star of the market!</div>
          </div>
        </div>
      </div>

      <div class="product-tile">
        <img src="pictures/brownies.jpg" alt="Brownies">
        <div class="product-overlay">
          <div>
            <div class="product-title">Fresh Brownies</div>
            <div class="product-description">Baked fresh every Saturday morning.</div>
          </div>
        </div>
      </div>

      <div class="product-tile">
        <img src="pictures/vaniliacupcakes.jpg" alt="Cupcakes">
        <div class="product-overlay">
          <div>
            <div class="product-title">Assorted Cupcakes</div>
            <div class="product-description">Vanilla, chocolate, and seasonal flavors available.</div>
          </div>
        </div>
      </div>

      <div class="product-tile">
        <img src="pictures\icedshortbread.jpg" alt="Biscuits">
        <div class="product-overlay">
          <div>
            <div class="product-title">Biscuit Selection</div>
            <div class="product-description">Handmade biscuits perfect for a cosy treat.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="social-links">
    <p style="font-size: 1.2rem; color: #667eea; font-weight: bold;">Follow us for weekly bakes & updates! üç™</p>
    <div class="social-icons">
      <a href="https://instagram.com/cupcakesontheavenue" target="_blank">
        <img src="pictures/instagram.png" alt="Instagram" width="45" height="45">
      </a>
      <a href="https://www.facebook.com/profile.php?id=61578246007533" target="_blank">
        <svg width="45" height="45" viewBox="0 0 24 24" fill="#1877F2">
          <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
        </svg>
      </a>
      <a href="https://tiktok.com/@Cupcakesontheheaven" target="_blank">
        <img src="pictures/tiktok.png" alt="TikTok" width="45" height="45">
      </a>
    </div>
  </div>
</section>

<div class="calendar-overlay" id="calendarOverlay"></div>
<div class="calendar-popup" id="calendarPopup">
  <button class="close-calendar" id="closeCalendar">√ó</button>
  <div class="calendar-nav">
    <button id="prevMonth">‚óÄ</button>
    <span id="monthYear"></span>
    <button id="nextMonth">‚ñ∂</button>
  </div>
  <div id="calendar"></div>
</div>

<section id="special-request">
  <h2>üíå Special Request</h2>
  <p style="text-align: center; margin-bottom: 25px; color: #666; font-size: 1.1rem;">
    Have a custom order or special requirement? Let us know!
  </p>
  <form id="specialForm">
    <input type="text" id="srName" placeholder="Your Name *" required>
    <input type="email" id="srEmail" placeholder="Your Email *" required>
    <textarea id="srMessage" rows="5" placeholder="Describe your special request... *" required></textarea>
    <button type="submit">Send Request</button>
  </form>
</section>

<div id="toast"></div>

<footer>
  <p style="font-size: 1.2rem; color: #667eea; font-weight: bold;">¬© 2025 Cupcakes on the Avenue</p>
  <p style="margin: 10px 0; color: #666;">üìß CupcakesontheAvenue@gmail.com</p>
  <p style="margin: 10px 0; color: #666;">üé™ Highworth Market ‚Ä¢ Every Saturday 8am-2pm</p>
  <img src="pictures/food hygiene.jpg" alt="Food Hygiene Rating 5">
</footer>

<script>
const BACKEND_BASE = 'https://sumup-backend.vercel.app'; // Try this instead

document.addEventListener('DOMContentLoaded', () => {
  let cart = [];
  let currentMonth = new Date().getMonth();
  let currentYear = new Date().getFullYear();
  let blockedDates = JSON.parse(localStorage.getItem('blockedDates') || '[]');

  const WEBHOOK_URL = "https://discord.com/api/webhooks/1426192909044023297/Ilgqgr8p7buI95ai-zssfphPLzQlNBBZf6PY31BhVuptPd-ZyccSq5kAQJPoBkUt4PHK";

  // Add to cart
  document.querySelectorAll('.add-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const name = btn.getAttribute('data-name');
      const selectId = btn.getAttribute('data-id');
      const select = document.querySelector(`[data-id="${selectId}"]`);
      const [size, price] = select.value.split('|');
      
      const item = {
        name: `${name} (${size})`,
        price: parseFloat(price),
        quantity: 1
      };

      const existing = cart.find(i => i.name === item.name);
      if (existing) {
        existing.quantity++;
      } else {
        cart.push(item);
      }

      updateCart();
      showToast(`‚úÖ ${name} added to cart!`);
    });
  });

  // Update cart display
  function updateCart() {
    const cartContents = document.getElementById('cartContents');
    const cartTotal = document.getElementById('cartTotal');
    const itemCount = document.getElementById('itemCount');

    if (cart.length === 0) {
      cartContents.innerHTML = '<p style="text-align: center; color: #999; padding: 30px;">Your cart is empty</p>';
      cartTotal.textContent = '¬£0.00';
      itemCount.textContent = '0 items';
      return;
    }

    let html = '<ul>';
    let total = 0;
    let count = 0;

    cart.forEach((item, index) => {
      total += item.price * item.quantity;
      count += item.quantity;
      html += `
        <li>
          <span>${item.name}</span>
          <span>¬£${item.price.toFixed(2)} √ó ${item.quantity}</span>
          <div class="cart-controls">
            <button class="cart-btn" onclick="changeQty(${index}, 1)">+</button>
            <button class="cart-btn" onclick="changeQty(${index}, -1)">‚àí</button>
          </div>
        </li>
      `;
    });

    html += '</ul>';
    cartContents.innerHTML = html;
    cartTotal.textContent = `¬£${total.toFixed(2)}`;
    itemCount.textContent = `${count} item${count !== 1 ? 's' : ''}`;
  }

  // Change quantity
  window.changeQty = (index, delta) => {
    cart[index].quantity += delta;
    if (cart[index].quantity <= 0) {
      cart.splice(index, 1);
    }
    updateCart();
  };

  // Market toggle
  document.getElementById('marketToggle').addEventListener('click', function() {
    const bakes = document.getElementById('marketBakes');
    if (bakes.classList.contains('show')) {
      bakes.classList.remove('show');
      this.textContent = 'See This Week\'s Bakes';
    } else {
      bakes.classList.add('show');
      this.textContent = 'Hide This Week\'s Bakes';
    }
  });

  // Calendar
  document.getElementById('deliveryDate').addEventListener('click', () => {
    document.getElementById('calendarOverlay').style.display = 'block';
    document.getElementById('calendarPopup').style.display = 'block';
    renderCalendar();
  });

  document.getElementById('closeCalendar').addEventListener('click', closeCalendar);
  document.getElementById('calendarOverlay').addEventListener('click', closeCalendar);

  function closeCalendar() {
    document.getElementById('calendarOverlay').style.display = 'none';
    document.getElementById('calendarPopup').style.display = 'none';
  }

  document.getElementById('prevMonth').addEventListener('click', () => {
    currentMonth--;
    if (currentMonth < 0) {
      currentMonth = 11;
      currentYear--;
    }
    renderCalendar();
  });

  document.getElementById('nextMonth').addEventListener('click', () => {
    currentMonth++;
    if (currentMonth > 11) {
      currentMonth = 0;
      currentYear++;
    }
    renderCalendar();
  });

  function renderCalendar() {
    const cal = document.getElementById('calendar');
    const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
    document.getElementById('monthYear').textContent = `${monthNames[currentMonth]} ${currentYear}`;

    const firstDay = new Date(currentYear, currentMonth, 1).getDay();
    const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

    // Today at midnight
    const today = new Date();
    today.setHours(0,0,0,0);
    // Minimum selectable date = today + 7 days
    const minDate = new Date(today);
    minDate.setDate(minDate.getDate() + 7);

    let html = '<table><tr><th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th></tr><tr>';

    for (let i = 0; i < firstDay; i++) {
      html += '<td></td>';
    }

    for (let day = 1; day <= daysInMonth; day++) {
      const date = new Date(currentYear, currentMonth, day);
      date.setHours(0,0,0,0);
      const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
      const isBlocked = blockedDates.includes(dateStr);
      const isWeekend = date.getDay() === 0 || date.getDay() === 6;

      // Disable any date earlier than minDate (today + 7)
      const isBeforeMin = date < minDate;

      let className = '';
      if (isBeforeMin || isBlocked) className = 'disabled';
      else if (isWeekend) className = 'weekend';

      html += `<td class="${className}" data-date="${dateStr}">${day}</td>`;

      if ((firstDay + day) % 7 === 0) {
        html += '</tr><tr>';
      }
    }

    html += '</tr></table>';
    cal.innerHTML = html;

    cal.querySelectorAll('td[data-date]').forEach(td => {
      if (!td.classList.contains('disabled')) {
        td.addEventListener('click', () => {
          document.getElementById('deliveryDate').value = td.getAttribute('data-date');
          closeCalendar();
        });
      }
    });
  }

  // Place order
  document.getElementById('placeOrderBtn').addEventListener('click', async () => {
    const name = document.getElementById('customerName').value.trim();
    const email = document.getElementById('customerEmail').value.trim();
    const mobile = document.getElementById('customerMobile').value.trim();
    const address = document.getElementById('customerAddress').value.trim();
    const notes = document.getElementById('customerNotes').value.trim();
    const delivery = document.getElementById('deliveryMethod').value;
    const date = document.getElementById('deliveryDate').value;
    const privacy = document.getElementById('privacyCheck').checked;
    const terms = document.getElementById('termsCheck').checked;

    if (!name || !email || !mobile || !address || !delivery || !date) {
      showToast('‚ö†Ô∏è Please fill all required fields!');
      return;
    }

    if (!/^[0-9]{11}$/.test(mobile)) {
      showToast('‚ö†Ô∏è Please enter a valid 11-digit UK mobile number!');
      return;
    }

    if (!privacy || !terms) {
      showToast('‚ö†Ô∏è Please accept Privacy Policy and Terms!');
      return;
    }

    if (cart.length === 0) {
      showToast('‚ö†Ô∏è Your cart is empty!');
      return;
    }

    const total = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0);
    const items = cart.map((i, idx) => `${idx + 1}. ${i.name} √ó ${i.quantity} = ¬£${(i.price * i.quantity).toFixed(2)}`).join('\n');

    const message = `üßÅ **NEW ORDER** üßÅ

**Customer:** ${name}
**Email:** ${email}
**Mobile:** ${mobile}
**Address:** ${address}
**Delivery:** ${delivery}
**Date:** ${date}
**Notes:** ${notes || 'None'}

**ORDER:**
${items}

**TOTAL: ¬£${total.toFixed(2)}**`;

    const orderBtn = document.getElementById('placeOrderBtn');
    orderBtn.disabled = true;
    orderBtn.textContent = 'Processing...';

    try {
      console.log('Sending order to Discord...');
      
      // Send to Discord
      const discordResponse = await fetch(WEBHOOK_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ content: message })
      });

      if (!discordResponse.ok) {
        throw new Error('Discord webhook failed');
      }

      console.log('‚úÖ Discord message sent');

      // Send email (non-blocking)
      fetch(`${BACKEND_BASE}/api/send-email`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          email, name, mobile, orderItems: items,
          total: `¬£${total.toFixed(2)}`, delivery, date, address,
          notes: notes || 'None', businessPhone: '07842817789'
        })
      }).then(() => console.log('‚úÖ Email sent'))
        .catch(err => console.warn('‚ö†Ô∏è Email failed:', err));

      // Redirect to SumUp payment
      const reference = 'ORDER-' + Date.now();
      const paymentUrl = `${BACKEND_BASE}/api/checkout?total=${total.toFixed(2)}&reference=${reference}`;
      
      console.log('Redirecting to:', paymentUrl);
      window.location.href = paymentUrl;

    } catch (error) {
      console.error('‚ùå Order failed:', error);
      showToast('‚ö†Ô∏è Failed to place order. Please try again.');
      orderBtn.disabled = false;
      orderBtn.textContent = 'Place Order & Pay';
    }
  });

  // Special request form
  document.getElementById('specialForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const name = document.getElementById('srName').value.trim();
    const email = document.getElementById('srEmail').value.trim();
    const message = document.getElementById('srMessage').value.trim();

    if (!name || !email || !message) {
      showToast('‚ö†Ô∏è Please fill all fields!');
      return;
    }

    const webhookMessage = `üíå **SPECIAL REQUEST**\n\n**Name:** ${name}\n**Email:** ${email}\n**Message:**\n${message}`;

    try {
      await fetch(WEBHOOK_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ content: webhookMessage })
      });

      showToast('‚úÖ Request sent successfully!');
      document.getElementById('specialForm').reset();
    } catch (error) {
      showToast('‚ö†Ô∏è Failed to send request.');
    }
  });

  // Payment integration
  function initiatePayment(total, orderReference) {
    window.location.href = `${BACKEND_BASE}/api/create-checkout?total=${total}&reference=${orderReference}`;
  }

  // Email notification
  async function sendOrderConfirmation(orderData) {
    await fetch('https://sumup-backend-ka4im7xlf-jack-wicks-projects.vercel.app/api/send-email', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(orderData)
    });
  }

  // Toast notification
  function showToast(message, duration = 3000) {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.classList.add('show');
    setTimeout(() => {
      toast.classList.remove('show');
    }, duration);
  }

  // Snowflakes animation
  function createSnowflake() {
    const snowflake = document.createElement('div');
    snowflake.classList.add('snowflake');
    snowflake.textContent = '‚ùÑ';
    snowflake.style.left = Math.random() * window.innerWidth + 'px';
    snowflake.style.animationDuration = Math.random() * 3 + 2 + 's';
    snowflake.style.opacity = Math.random();
    snowflake.style.fontSize = Math.random() * 10 + 10 + 'px';
    document.body.appendChild(snowflake);

    setTimeout(() => {
      snowflake.remove();
    }, 5000);
  }

  setInterval(createSnowflake, 300);

  // Lead time radio toggle (show phone if "No")
  const leadTimeYes = document.getElementById('leadTimeYes');
  const leadTimeNo = document.getElementById('leadTimeNo');
  const leadTimeWarning = document.getElementById('leadTimeWarning');

  function updateLeadTimeWarning() {
    if (leadTimeNo && leadTimeNo.checked) {
      leadTimeWarning.style.display = 'block';
    } else {
      leadTimeWarning.style.display = 'none';
    }
  }
  if (leadTimeYes && leadTimeNo) {
    leadTimeYes.addEventListener('change', updateLeadTimeWarning);
    leadTimeNo.addEventListener('change', updateLeadTimeWarning);
    updateLeadTimeWarning();
  }
});
</script>
</body>
</html>