<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover"/>
<title>Cupcakes on the Avenue - Premium Baked Goods & Custom Cakes | Highworth Market</title>
<meta name="description" content="Artisan cupcakes, custom celebration cakes & exclusive Shortbread Delights. Visit us at Highworth Market Saturdays or order online. Fresh baked goods made with love.">
<meta name="keywords" content="cupcakes, cakes, bakery, Highworth, custom cakes, shortbread, celebration cakes, fresh baked goods, artisan bakery">
<meta name="author" content="Cupcakes on the Avenue">
<meta name="robots" content="index, follow">

<!-- PWA Meta Tags -->
<meta name="theme-color" content="#667eea">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Cupcakes Avenue">
<meta name="mobile-web-app-capable" content="yes">
<meta name="format-detection" content="telephone=no">

<!-- Web App Manifest -->
<link rel="manifest" href="manifest.json">

<!-- Apple Touch Icons -->
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üßÅ</text></svg>">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://cupcakesontheavenue.co.uk">
<meta property="og:title" content="Cupcakes on the Avenue - Premium Baked Goods & Custom Cakes">
<meta property="og:description" content="Artisan cupcakes, custom celebration cakes & exclusive Shortbread Delights. Visit us at Highworth Market or order online.">
<meta property="og:image" content="https://cupcakesontheavenue.co.uk/pictures/logo.png">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://cupcakesontheavenue.co.uk">
<meta property="twitter:title" content="Cupcakes on the Avenue - Premium Baked Goods & Custom Cakes">
<meta property="twitter:description" content="Artisan cupcakes, custom celebration cakes & exclusive Shortbread Delights. Visit us at Highworth Market or order online.">
<meta property="twitter:image" content="https://cupcakesontheavenue.co.uk/pictures/logo.png">

<!-- Structured Data -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Bakery",
  "name": "Cupcakes on the Avenue",
  "description": "Artisan bakery specializing in cupcakes, custom celebration cakes, and exclusive Shortbread Delights",
  "url": "https://cupcakesontheavenue.co.uk",
  "telephone": "07842817789",
  "email": "cupcakesontheavenue@gmail.com",
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "Highworth",
    "addressCountry": "UK"
  },
  "openingHours": "Sa 08:00-14:00",
  "paymentAccepted": "Cash, Card, Online Payment",
  "priceRange": "¬£3-¬£70",
  "servesCuisine": "Bakery",
  "hasMenu": {
    "@type": "Menu",
    "hasMenuSection": [
      {
        "@type": "MenuSection",
        "name": "Regular Bakes",
        "hasMenuItem": [
          {
            "@type": "MenuItem",
            "name": "Shortbread Delight",
            "description": "Our signature buttery, melt-in-your-mouth shortbread",
            "offers": {
              "@type": "Offer",
              "price": "20-30",
              "priceCurrency": "GBP"
            }
          }
        ]
      }
    ]
  }
}
</script>

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'GA_MEASUREMENT_ID');
  
  // Custom events for tracking
  function trackPurchase(orderTotal, items) {
    gtag('event', 'purchase', {
      transaction_id: Math.random().toString(36).substr(2, 9),
      value: orderTotal,
      currency: 'GBP',
      items: items.map(item => ({
        item_id: item.name.toLowerCase().replace(/\s+/g, '_'),
        item_name: item.name,
        category: 'Baked Goods',
        quantity: item.quantity,
        price: item.price
      }))
    });
  }
  
  function trackProductView(productName) {
    gtag('event', 'view_item', {
      currency: 'GBP',
      value: 0,
      items: [{
        item_id: productName.toLowerCase().replace(/\s+/g, '_'),
        item_name: productName,
        category: 'Baked Goods',
        quantity: 1
      }]
    });
  }
  
  function trackAddToCart(productName, price) {
    gtag('event', 'add_to_cart', {
      currency: 'GBP',
      value: price,
      items: [{
        item_id: productName.toLowerCase().replace(/\s+/g, '_'),
        item_name: productName,
        category: 'Baked Goods',
        quantity: 1,
        price: price
      }]
    });
  }
</script>

<link rel="icon" type="image/x-icon" href="pictures/favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="pictures/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="pictures/favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="pictures/apple-touch-icon.png">
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  color: #333;
  transition: background 1s ease-in-out;
}

/* Seasonal Theme Variables */
body.spring {
  background: linear-gradient(135deg, #90EE90 0%, #32CD32 100%);
}

body.summer {
  background: linear-gradient(135deg, #FFE135 0%, #FFA500 100%);
}

body.autumn {
  background: linear-gradient(135deg, #FF6B35 0%, #8B4513 100%);
}

body.winter {
  background: linear-gradient(135deg, #B0E0E6 0%, #4682B4 100%);
}

/* Header */
header {
  background: rgba(255, 255, 255, 0.95);
  padding: 20px;
  text-align: center;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

header h1 {
  color: #667eea;
  font-size: 2.5rem;
  margin-bottom: 10px;
}

header p {
  color: #666;
  font-size: 1.1rem;
  margin-bottom: 15px;
}

nav a {
  color: #667eea;
  text-decoration: none;
  margin: 0 15px;
  font-weight: 600;
  transition: color 0.3s;
}

nav a:hover {
  color: #764ba2;
}

/* Hero */
.hero {
  text-align: center;
  padding: 60px 20px;
  color: white;
}

.hero img {
  max-width: 300px;
  border-radius: 15px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  margin-bottom: 20px;
}

.hero h2 {
  font-size: 2.5rem;
  margin-bottom: 10px;
}

.hero p {
  font-size: 1.3rem;
  opacity: 0.9;
}

/* Sections */
section {
  max-width: 1400px;
  margin: 40px auto;
  padding: 40px 20px;
  background: rgba(255, 255, 255, 0.25);
  backdrop-filter: blur(15px);
  border-radius: 25px;
  box-shadow: 0 15px 35px rgba(0,0,0,0.15), 0 5px 15px rgba(0,0,0,0.08);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
  color: #2c3e50;
}

section p, section li, section label {
  text-shadow: 0 1px 2px rgba(255, 255, 255, 0.7);
}

section::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #667eea, #764ba2, #667eea);
  background-size: 200% 100%;
  animation: gradientShift 3s ease-in-out infinite;
}

section:hover {
  transform: translateY(-5px);
  box-shadow: 0 20px 40px rgba(0,0,0,0.18), 0 10px 20px rgba(0,0,0,0.12);
  background: rgba(255, 255, 255, 0.35);
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* Seasonal Section Adaptations */
body.spring section {
  background: rgba(255, 255, 255, 0.20);
  border: 1px solid rgba(144, 238, 144, 0.25);
  box-shadow: 0 15px 35px rgba(50, 205, 50, 0.12), 0 5px 15px rgba(50, 205, 50, 0.06);
}

body.spring section::before {
  background: linear-gradient(90deg, #90EE90, #32CD32, #90EE90);
  background-size: 200% 100%;
  animation: gradientShift 3s ease-in-out infinite;
}

body.summer section {
  background: rgba(255, 255, 255, 0.20);
  border: 1px solid rgba(255, 225, 53, 0.25);
  box-shadow: 0 15px 35px rgba(255, 165, 0, 0.12), 0 5px 15px rgba(255, 165, 0, 0.06);
}

body.summer section::before {
  background: linear-gradient(90deg, #FFE135, #FFA500, #FFE135);
  background-size: 200% 100%;
  animation: gradientShift 3s ease-in-out infinite;
}

body.autumn section {
  background: rgba(255, 255, 255, 0.20);
  border: 1px solid rgba(255, 107, 53, 0.25);
  box-shadow: 0 15px 35px rgba(255, 107, 53, 0.12), 0 5px 15px rgba(255, 107, 53, 0.06);
}

body.autumn section::before {
  background: linear-gradient(90deg, #FF6B35, #8B4513, #FF6B35);
  background-size: 200% 100%;
  animation: gradientShift 3s ease-in-out infinite;
}

body.winter section {
  background: rgba(255, 255, 255, 0.20);
  border: 1px solid rgba(176, 224, 230, 0.25);
  box-shadow: 0 15px 35px rgba(70, 130, 180, 0.12), 0 5px 15px rgba(70, 130, 180, 0.06);
}

body.winter section::before {
  background: linear-gradient(90deg, #B0E0E6, #4682B4, #B0E0E6);
  background-size: 200% 100%;
  animation: gradientShift 3s ease-in-out infinite;
}

/* Floating Particle Effect for Sections */
section::after {
  content: '';
  position: absolute;
  top: 10px;
  right: 20px;
  width: 6px;
  height: 6px;
  background: rgba(102, 126, 234, 0.3);
  border-radius: 50%;
  animation: float 4s ease-in-out infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.3; }
  50% { transform: translateY(-10px) rotate(180deg); opacity: 0.7; }
}

/* Enhanced Glass Effect on Hover */
section:hover {
  background: rgba(255, 255, 255, 0.35);
  backdrop-filter: blur(20px);
}

/* Seasonal Particle Colors */
body.spring section::after {
  background: rgba(50, 205, 50, 0.4);
}

body.summer section::after {
  background: rgba(255, 165, 0, 0.4);
}

body.autumn section::after {
  background: rgba(255, 107, 53, 0.4);
}

body.winter section::after {
  background: rgba(70, 130, 180, 0.4);
}

section h2 {
  text-align: center;
  font-size: 2.5rem;
  color: #667eea;
  margin-bottom: 40px;
  text-shadow: 0 2px 4px rgba(255, 255, 255, 0.8);
  font-weight: 700;
}

/* Product Tiles */
.products-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 30px;
}

.product-tile {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 20px;
  overflow: hidden;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.23, 1, 0.320, 1);
  position: relative;
  height: 350px;
  border: 2px solid rgba(255, 255, 255, 0.2);
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}

.product-tile::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
  transform: translateX(-100%);
  transition: transform 0.6s;
}

.product-tile:hover::before {
  transform: translateX(100%);
}

.product-tile:hover {
  transform: translateY(-15px) scale(1.02);
  box-shadow: 0 20px 50px rgba(102, 126, 234, 0.3);
  border-color: rgba(255, 255, 255, 0.4);
}

/* Seasonal Product Tile Styles */
body.spring .product-tile {
  background: linear-gradient(135deg, #90EE90 0%, #32CD32 100%);
}

body.spring .product-tile:hover {
  box-shadow: 0 20px 50px rgba(50, 205, 50, 0.3);
}

body.summer .product-tile {
  background: linear-gradient(135deg, #FFE135 0%, #FFA500 100%);
}

body.summer .product-tile:hover {
  box-shadow: 0 20px 50px rgba(255, 165, 0, 0.3);
}

body.autumn .product-tile {
  background: linear-gradient(135deg, #FF6B35 0%, #8B4513 100%);
}

body.autumn .product-tile:hover {
  box-shadow: 0 20px 50px rgba(255, 107, 53, 0.3);
}

body.winter .product-tile {
  background: linear-gradient(135deg, #B0E0E6 0%, #4682B4 100%);
}

body.winter .product-tile:hover {
  box-shadow: 0 20px 50px rgba(70, 130, 180, 0.3);
}

.product-tile img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.product-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.95);
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  padding: 25px;
  opacity: 0;
  transition: opacity 0.3s;
}

.product-tile:hover .product-overlay {
  opacity: 1;
}

.product-title {
  font-size: 1.5rem;
  font-weight: bold;
  color: #667eea;
  margin-bottom: 10px;
}

.product-description {
  color: #666;
  font-size: 1rem;
  line-height: 1.5;
  flex: 1;
}

.product-select {
  width: 100%;
  padding: 12px;
  border: 2px solid #667eea;
  border-radius: 8px;
  font-size: 1rem;
  margin-bottom: 10px;
  background: white;
}

.add-btn {
  width: 100%;
  padding: 14px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 8px;
  font-size: 1.1rem;
  font-weight: bold;
  cursor: pointer;
  transition: transform 0.2s;
}

.add-btn:hover {
  transform: scale(1.05);
}

/* Size Comparison Tooltip */
.size-tooltip {
  position: absolute;
  background: #333;
  color: white;
  padding: 15px;
  border-radius: 8px;
  font-size: 0.9rem;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
  z-index: 1000;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s;
  max-width: 200px;
}

.size-tooltip.show {
  opacity: 1;
}

.size-visual {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-top: 8px;
}

.size-circle {
  background: #667eea;
  border-radius: 50%;
  display: inline-block;
}

.size-6 { width: 20px; height: 20px; }
.size-8 { width: 26px; height: 26px; }
.size-10 { width: 32px; height: 32px; }

/* Cart */
.cart-section {
  max-width: 800px;
  margin: 40px auto;
  background: rgba(255, 255, 255, 0.25);
  backdrop-filter: blur(15px);
  border-radius: 25px;
  padding: 35px;
  box-shadow: 0 15px 35px rgba(0,0,0,0.15), 0 5px 15px rgba(0,0,0,0.08);
  border: 1px solid rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.cart-section::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #667eea, #764ba2, #667eea);
  background-size: 200% 100%;
  animation: gradientShift 3s ease-in-out infinite;
}

.cart-section:hover {
  transform: translateY(-5px);
  box-shadow: 0 20px 40px rgba(0,0,0,0.15), 0 10px 20px rgba(0,0,0,0.1);
}

.cart-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 25px;
  padding-bottom: 20px;
  border-bottom: 2px solid #f0f0f0;
}

.cart-header h2 {
  color: #667eea;
  margin: 0;
}

#itemCount {
  background: #667eea;
  color: white;
  padding: 8px 15px;
  border-radius: 20px;
  font-weight: bold;
}

.cart-items ul {
  list-style: none;
}

.cart-items li {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px;
  margin-bottom: 10px;
  background: #f8f9fa;
  border-radius: 10px;
}

.cart-controls {
  display: flex;
  gap: 10px;
}

.cart-btn {
  width: 35px;
  height: 35px;
  border: 2px solid #667eea;
  background: white;
  color: #667eea;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.2s;
}

.cart-btn:hover {
  background: #667eea;
  color: white;
}

.cart-total {
  display: flex;
  justify-content: space-between;
  padding: 20px;
  background: #f8f9fa;
  border-radius: 10px;
  font-size: 1.5rem;
  font-weight: bold;
  color: #667eea;
  margin-top: 20px;
}

.customer-form input,
.customer-form select,
.customer-form textarea {
  width: 100%;
  padding: 12px;
  margin: 10px 0;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 1rem;
}

.customer-form input:focus,
.customer-form select:focus {
  border-color: #667eea;
  outline: none;
}

.checkbox-group {
  margin: 15px 0;
}

.checkbox-group label {
  display: flex;
  align-items: center;
  margin: 8px 0;
  cursor: pointer;
}

.checkbox-group input[type="checkbox"] {
  width: auto;
  margin-right: 10px;
}

.order-btn {
  width: 100%;
  padding: 18px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.2rem;
  font-weight: bold;
  cursor: pointer;
  margin-top: 20px;
  transition: transform 0.2s;
}

.order-btn:hover {
  transform: scale(1.02);
}

/* Calendar */
.calendar-overlay {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.7);
  z-index: 999;
}

.calendar-popup {
  display: none;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: white;
  padding: 30px;
  border-radius: 15px;
  box-shadow: 0 10px 50px rgba(0,0,0,0.3);
  z-index: 1000;
  max-width: 400px;
  width: 90%;
}

.calendar-nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.calendar-nav button {
  background: #667eea;
  color: white;
  border: none;
  padding: 8px 15px;
  border-radius: 5px;
  cursor: pointer;
}

.calendar-nav span {
  font-size: 1.2rem;
  font-weight: bold;
  color: #667eea;
}

#calendar table {
  width: 100%;
  border-collapse: collapse;
}

#calendar th,
#calendar td {
  padding: 10px;
  text-align: center;
  border: 1px solid #e0e0e0;
}

#calendar th {
  background: #667eea;
  color: white;
  font-weight: bold;
}

#calendar td {
  cursor: pointer;
  transition: background 0.2s;
}

#calendar td:hover:not(.disabled) {
  background: #e8eaf6;
}

#calendar td.disabled {
  color: #ccc;
  cursor: not-allowed;
  background: #f5f5f5;
}

#calendar td.weekend {
  background: #fff3e0;
}

.close-calendar {
  position: absolute;
  top: 10px;
  right: 15px;
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: #667eea;
}

/* Toast */
#toast {
  visibility: hidden;
  min-width: 300px;
  background: #667eea;
  color: white;
  text-align: center;
  border-radius: 10px;
  padding: 16px;
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10000;
  font-size: 1rem;
  box-shadow: 0 5px 15px rgba(0,0,0,0.3);
  opacity: 0;
  transition: opacity 0.3s, visibility 0.3s;
}

#toast.show {
  visibility: visible;
  opacity: 1;
}

/* Snowflakes */
.snowflake {
  position: fixed;
  top: -10vh;
  color: white;
  font-size: 20px;
  pointer-events: none;
  z-index: 10000;
  animation: fall linear infinite, sway ease-in-out infinite;
}

@keyframes fall {
  to { transform: translateY(120vh); }
}

@keyframes sway {
  0%, 100% { margin-left: 0; }
  50% { margin-left: 50px; }
}

/* Market Section */
.market-toggle {
  display: block;
  margin: 0 auto 30px;
  padding: 15px 40px;
  background: #667eea;
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.2rem;
  font-weight: bold;
  cursor: pointer;
  transition: background 0.3s;
}

.market-toggle:hover {
  background: #764ba2;
}

.market-bakes {
  display: none;
}

.market-bakes.show {
  display: block;
}

.social-links {
  text-align: center;
  margin-top: 30px;
}

.social-icons {
  display: flex;
  gap: 20px;
  justify-content: center;
  margin-top: 15px;
}

.social-icons a {
  transition: transform 0.2s;
}

.social-icons a:hover {
  transform: scale(1.2);
}

/* Footer */
footer {
  background: white;
  text-align: center;
  padding: 40px 20px;
  margin-top: 60px;
  box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
}

footer img {
  max-width: 200px;
  margin-top: 20px;
  border-radius: 10px;
}

/* Special Request */
#special-request form input,
#special-request form textarea {
  width: 100%;
  padding: 12px;
  margin: 10px 0;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 1rem;
}

#special-request form button {
  width: 100%;
  padding: 15px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.1rem;
  font-weight: bold;
  cursor: pointer;
  margin-top: 10px;
}

/* New lead time section styles */
.leadtime-group {
  margin: 15px 0;
  padding: 12px;
  background: #f8f9fa;
  border-radius: 10px;
  border: 1px solid #e0e0e0;
}

.leadtime-group p {
  margin-bottom: 8px;
  color: #444;
  font-weight: 600;
}

.leadtime-group label {
  margin-right: 15px;
  font-weight: 500;
}

.leadtime-note {
  margin-top: 8px;
  color: #b45309; /* amber */
  background: #fffbeb;
  border: 1px solid #fde68a;
  padding: 8px 10px;
  border-radius: 8px;
}

.site-footer {
  margin-top: 40px;
  padding: 30px 20px;
  background: rgba(247, 247, 248, 0.25);
  backdrop-filter: blur(15px);
  border-top: 1px solid rgba(234, 234, 234, 0.3);
  text-align: center;
  color: #333;
  border-radius: 25px 25px 0 0;
  position: relative;
}

.site-footer::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(90deg, #667eea, #764ba2, #667eea);
  background-size: 200% 100%;
  animation: gradientShift 3s ease-in-out infinite;
}

.site-footer nav {
  margin-bottom: 15px;
}

.site-footer nav a {
  margin: 0 15px;
  color: #0b66c3;
  text-decoration: none;
  transition: all 0.3s ease;
  padding: 8px 12px;
  border-radius: 8px;
}

.site-footer nav a:hover { 
  text-decoration: underline;
  background: rgba(11, 102, 195, 0.1);
  transform: translateY(-2px);
}

.admin-link:hover {
  opacity: 1 !important;
  color: #667eea !important;
  transform: scale(1.2) translateY(-2px) !important;
}

/* Account System Styles */
.account-section {
  max-width: 800px;
  margin: 40px auto;
  background: white;
  border-radius: 20px;
  padding: 30px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
  display: none;
}

.account-tabs {
  display: flex;
  gap: 0;
  margin-bottom: 30px;
  border: 2px solid #667eea;
  border-radius: 10px;
  overflow: hidden;
}

.account-tab {
  flex: 1;
  padding: 15px;
  background: white;
  border: none;
  cursor: pointer;
  font-weight: bold;
  transition: all 0.3s;
}

.account-tab.active {
  background: #667eea;
  color: white;
}

.account-content {
  display: none;
}

.account-content.active {
  display: block;
}

.auth-form input {
  width: 100%;
  padding: 12px;
  margin: 10px 0;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 1rem;
}

.auth-form button {
  width: 100%;
  padding: 15px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.1rem;
  font-weight: bold;
  cursor: pointer;
  margin-top: 10px;
}

.guest-checkout {
  text-align: center;
  margin: 20px 0;
  padding: 20px;
  background: #f8f9fa;
  border-radius: 10px;
}

.guest-btn {
  background: #28a745;
  color: white;
  padding: 12px 30px;
  border: none;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  margin-top: 10px;
}

.order-history {
  margin-top: 20px;
}

.order-item {
  background: #f8f9fa;
  padding: 15px;
  margin: 10px 0;
  border-radius: 10px;
  border-left: 4px solid #667eea;
}

.loyalty-points {
  background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
  padding: 20px;
  border-radius: 10px;
  text-align: center;
  margin: 20px 0;
  color: #333;
}

/* Wishlist Heart Icon */
.wishlist-heart {
  position: absolute;
  top: 15px;
  right: 15px;
  font-size: 24px;
  cursor: pointer;
  transition: all 0.3s;
  z-index: 100;
  color: #ccc;
}

.wishlist-heart:hover,
.wishlist-heart.loved {
  color: #ff6b6b;
  transform: scale(1.2);
}

.product-tile {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 15px;
  overflow: hidden;
  cursor: pointer;
  transition: transform 0.3s, box-shadow 0.3s;
  position: relative;
  height: 350px;
}

/* Recommended Products */
.recommendations-section {
  background: #f8f9fa;
  padding: 30px;
  border-radius: 15px;
  margin: 30px 0;
}

.recommendations-section h3 {
  color: #667eea;
  margin-bottom: 20px;
  text-align: center;
}

.recommendations-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
}

.recommendation-item {
  background: white;
  border-radius: 10px;
  padding: 15px;
  text-align: center;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  transition: transform 0.3s;
}

.recommendation-item:hover {
  transform: translateY(-5px);
}

.recommendation-item img {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  object-fit: cover;
  margin-bottom: 10px;
}

/* Loading Animations */
.loading-spinner {
  border: 4px solid #f3f3f3;
  border-top: 4px solid #667eea;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
  margin: 20px auto;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.skeleton {
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
}

@keyframes loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

.skeleton-product {
  height: 350px;
  border-radius: 15px;
  margin-bottom: 20px;
}

.skeleton-text {
  height: 20px;
  margin: 10px 0;
  border-radius: 4px;
}

.skeleton-title {
  height: 24px;
  width: 80%;
  margin: 15px auto;
  border-radius: 4px;
}

.fade-in {
  animation: fadeIn 0.5s ease-in;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.slide-in {
  animation: slideIn 0.6s ease-out;
}

@keyframes slideIn {
  from { transform: translateX(-100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

.zoom-in {
  animation: zoomIn 0.4s ease-out;
}

@keyframes zoomIn {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

/* Popular Items Dashboard */
.popular-badge {
  position: absolute;
  top: 10px;
  left: 10px;
  background: linear-gradient(45deg, #FF6B6B, #FF8E8E);
  color: white;
  padding: 5px 10px;
  border-radius: 15px;
  font-size: 0.8rem;
  font-weight: bold;
  z-index: 10;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

.trending-indicator {
  position: absolute;
  top: 10px;
  right: 50px;
  background: #FFD700;
  color: #333;
  padding: 3px 8px;
  border-radius: 10px;
  font-size: 0.7rem;
  font-weight: bold;
  z-index: 10;
}

.popular-dashboard {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 30px;
  border-radius: 20px;
  margin: 40px auto;
  max-width: 1200px;
  text-align: center;
}

.popular-stats {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.stat-card {
  background: rgba(255, 255, 255, 0.1);
  padding: 20px;
  border-radius: 15px;
  backdrop-filter: blur(10px);
}

.stat-number {
  font-size: 2rem;
  font-weight: bold;
  color: #FFD700;
}

/* Countdown Timer */
.countdown-banner {
  background: linear-gradient(45deg, #FF6B35, #F7931E);
  color: white;
  padding: 20px;
  text-align: center;
  margin: 20px 0;
  border-radius: 15px;
  position: relative;
  overflow: hidden;
}

.countdown-banner::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  animation: shimmer 2s infinite;
}

@keyframes shimmer {
  0% { left: -100%; }
  100% { left: 100%; }
}

.countdown-timer {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 10px;
}

.countdown-unit {
  background: rgba(255, 255, 255, 0.2);
  padding: 10px 15px;
  border-radius: 10px;
  min-width: 60px;
}

.countdown-number {
  font-size: 1.5rem;
  font-weight: bold;
}

/* Sticky Cart Bar */
.sticky-cart {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background: rgba(255, 255, 255, 0.98);
  backdrop-filter: blur(10px);
  border-bottom: 2px solid #667eea;
  padding: 15px 20px;
  z-index: 1000;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 2px 20px rgba(0,0,0,0.1);
  transform: translateY(-100%);
  transition: transform 0.3s ease;
}

.sticky-cart.show {
  transform: translateY(0);
}

.cart-summary {
  display: flex;
  align-items: center;
  gap: 20px;
}

.cart-icon {
  font-size: 1.5rem;
  color: #667eea;
}

.cart-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.cart-count {
  font-weight: bold;
  color: #333;
}

.cart-total {
  color: #667eea;
  font-size: 0.9rem;
}

.mini-checkout-btn {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 25px;
  font-weight: bold;
  cursor: pointer;
  transition: transform 0.2s;
  text-decoration: none;
  display: inline-block;
}

.mini-checkout-btn:hover {
  transform: scale(1.05);
}

.mini-checkout-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.countdown-label {
  font-size: 0.8rem;
  opacity: 0.9;
}

.limited-offer {
  position: absolute;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  background: #FF4444;
  color: white;
  padding: 5px 15px;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: bold;
  animation: bounce 1s infinite alternate;
}

@keyframes bounce {
  0% { transform: translateX(-50%) translateY(0); }
  100% { transform: translateX(-50%) translateY(-5px); }
}

@media (max-width: 768px) {
  /* Mobile App-Style Optimizations */
  body {
    padding-top: 140px; /* More space for sticky cart on mobile */
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
  }
  
  /* App-style header */
  header {
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(102, 126, 234, 0.2);
    box-shadow: 0 2px 20px rgba(0,0,0,0.1);
    margin-bottom: 15px;
    padding: 15px;
  }
  
  header h1 {
    font-size: 1.8rem;
    margin-bottom: 8px;
  }
  
  header p {
    font-size: 0.9rem;
    margin-bottom: 10px;
  }
  
  /* App-style navigation */
  nav {
    display: flex;
    justify-content: space-around;
    background: rgba(102, 126, 234, 0.1);
    border-radius: 20px;
    padding: 8px;
    margin-top: 10px;
  }
  
  nav a {
    padding: 8px 12px;
    border-radius: 15px;
    font-size: 0.85rem;
    transition: all 0.3s ease;
  }
  
  nav a:hover, nav a.active {
    background: rgba(102, 126, 234, 0.2);
    transform: scale(1.05);
  }
  
  /* Mobile sections */
  section {
    margin: 15px 10px;
    padding: 25px 15px;
    border-radius: 20px;
  }
  
  section h2 {
    font-size: 1.8rem;
    margin-bottom: 20px;
  }
  
  /* Single column grid for mobile */
  .products-grid {
    grid-template-columns: 1fr;
    gap: 15px;
  }
  
  .product-tile {
    height: 300px;
    border-radius: 18px;
  }
  
  /* Mobile hero */
  .hero {
    padding: 30px 15px;
  }
  
  .hero h2 {
    font-size: 1.8rem;
  }
  
  .hero p {
    font-size: 1.1rem;
  }
  
  .hero img {
    max-width: 250px;
  }
  
  /* Mobile sticky cart */
  .sticky-cart {
    padding: 12px 15px;
    border-bottom: 1px solid rgba(102, 126, 234, 0.2);
  }
  
  .cart-summary {
    gap: 15px;
  }
  
  .cart-icon {
    font-size: 1.3rem;
  }
  
  .cart-count, .cart-total {
    font-size: 0.9rem;
  }
  
  .mini-checkout-btn {
    padding: 8px 15px;
    font-size: 0.9rem;
  }
  
  /* Mobile-friendly buttons */
  .add-btn, .order-btn {
    padding: 12px;
    font-size: 1rem;
    border-radius: 12px;
  }
  
  /* Hide mouse hover effects on touch devices */
  .product-tile:hover {
    transform: none;
  }
  
  /* Touch-friendly tap effects */
  .product-tile:active {
    transform: scale(0.98);
    transition: transform 0.1s ease;
  }
  
  .add-btn:active, .order-btn:active {
    transform: scale(0.95);
  }
}

/* Extra small screens - full app experience */
@media (max-width: 480px) {
  header h1 {
    font-size: 1.5rem;
  }
  
  nav a {
    font-size: 0.75rem;
    padding: 6px 8px;
  }
  
  section {
    margin: 10px 5px;
    padding: 20px 12px;
  }
  
  .hero {
    padding: 20px 10px;
  }
  
  .hero h2 {
    font-size: 1.5rem;
  }
}
</style>
</head>
<body>

<!-- Sticky Cart Bar -->
<div class="sticky-cart" id="stickyCart">
  <div class="cart-summary">
    <div class="cart-icon">üõí</div>
    <div class="cart-info">
      <div class="cart-count" id="stickyCartCount">0 items</div>
      <div class="cart-total" id="stickyCartTotal">¬£0.00</div>
    </div>
  </div>
  <div>
    <a href="shop.html" class="mini-checkout-btn">Go to Shop</a>
  </div>
</div>

<header role="banner">
  <h1>üßÅ Cupcakes on the Avenue</h1>
  <p>Home of the exclusive Shortbread Delight & cosy bakes!</p>
  <nav role="navigation" aria-label="Main navigation">
    <a href="#about" aria-label="Learn about us">About</a>
    <a href="#festive" aria-label="View festive bakes">Festive Bakes</a>
    <a href="shop.html" aria-label="Browse our shop">Shop</a>
    <a href="#market" aria-label="Visit us at market">Market</a>
    <a href="#account" id="accountLink" aria-label="Access your account">üë§ Account</a>
  </nav>
</header>

<!-- Account System -->
<div id="account" class="account-section">
  <div class="account-tabs">
    <button class="account-tab active" data-tab="login">Login</button>
    <button class="account-tab" data-tab="register">Register</button>
    <button class="account-tab" data-tab="profile">Profile</button>
  </div>

  <!-- Login Tab -->
  <div class="account-content active" id="login">
    <h3>Welcome Back!</h3>
    <form class="auth-form" id="loginForm">
      <input type="email" placeholder="Email Address" required>
      <input type="password" placeholder="Password" required>
      <button type="submit">Login</button>
    </form>
    
    <div class="guest-checkout">
      <h4>Don't have an account?</h4>
      <p>No worries! You can still place orders as a guest.</p>
      <button class="guest-btn" id="guestCheckoutBtn">Continue as Guest</button>
    </div>
  </div>

  <!-- Register Tab -->
  <div class="account-content" id="register">
    <h3>Create Account</h3>
    <form class="auth-form" id="registerForm">
      <input type="text" placeholder="Full Name" required>
      <input type="email" placeholder="Email Address" required>
      <input type="tel" placeholder="Mobile Number" required>
      <input type="text" placeholder="Address" required>
      <input type="password" placeholder="Password" required>
      <input type="password" placeholder="Confirm Password" required>
      <button type="submit">Create Account</button>
    </form>
  </div>

  <!-- Profile Tab -->
  <div class="account-content" id="profile">
    <h3>My Account</h3>
    <div class="loyalty-points">
      <h4>üåü Loyalty Points</h4>
      <p style="font-size: 1.5rem; font-weight: bold;" id="loyaltyPoints">0 Points</p>
      <p>Earn 1 point for every ¬£1 spent ‚Ä¢ 100 points = ¬£5 off</p>
    </div>
    
    <div class="order-history">
      <h4>üìã Order History</h4>
      <div id="orderHistoryList">
        <p style="color: #999; text-align: center; padding: 20px;">No orders yet</p>
      </div>
    </div>
    
    <div style="margin-top: 20px;">
      <h4>üë• Referral Program</h4>
      <p>Share your referral code: <strong id="referralCode">COTA123</strong></p>
      <p>Get ¬£5 off when someone uses your code!</p>
    </div>
  </div>
</div>

<div class="hero">
  <img src="pictures/logo.png" alt="Cupcakes on the Avenue">
  <h2>Where every bake feels like home</h2>
  <p>Fresh cupcakes, biscuits, and celebration cakes baked with love!</p>
</div>

<!-- Halloween Special Countdown -->
<div class="countdown-banner" id="countdownBanner">
  <h3>üéÉ Halloween Special - 20% Off All Orders!</h3>
  <p>Limited time offer ends in:</p>
  <div class="countdown-timer" id="countdownTimer">
    <div class="countdown-unit">
      <div class="countdown-number" id="hours">00</div>
      <div class="countdown-label">Hours</div>
    </div>
    <div class="countdown-unit">
      <div class="countdown-number" id="minutes">00</div>
      <div class="countdown-label">Minutes</div>
    </div>
    <div class="countdown-unit">
      <div class="countdown-number" id="seconds">00</div>
      <div class="countdown-label">Seconds</div>
    </div>
  </div>
</div>

<section id="about">
  <h2>About Us</h2>
  <p style="text-align: center; font-size: 1.2rem; line-height: 1.8; max-width: 800px; margin: 0 auto; color: #666;">
    At Cupcakes on the Avenue, every bake feels like home. From our exclusive Shortbread Delight to cupcakes, biscuits, and cakes made for celebrating, everything is baked with love and a sprinkle of fun. Find us at Highworth Market every Saturday or order online for custom treats.
  </p>
</section>

<section id="festive">
  <h2>üéÑ Festive Bakes</h2>
  <div class="products-grid" style="justify-items: center;">
    
    <div class="product-tile">
      <div class="wishlist-heart" data-product="Christmas Cake with Royal Icing">‚ô°</div>
      <img src="pictures/marzipan.jpg" alt="Christmas Cake">
      <div class="product-overlay">
        <div>
          <div class="product-title">Christmas Cake with Royal Icing</div>
          <div class="product-description">Traditional Christmas cake with elegant royal icing. Available with or without alcohol.</div>
        </div>
        <div>
          <select class="product-select" data-id="festive-1">
            <option value="6 inch|30">6 inch - ¬£30</option>
            <option value="8 inch|40">8 inch - ¬£40</option>
          </select>
          <button class="add-btn" data-name="Christmas Cake - Royal Icing" data-id="festive-1">Add to Cart</button>
        </div>
      </div>
    </div>

    <div class="product-tile">
      <div class="wishlist-heart" data-product="Christmas Cake with Marzipan">‚ô°</div>
      <img src="pictures/fondant.jpg" alt="Marzipan Cake">
      <div class="product-overlay">
        <div>
          <div class="product-title">Christmas Cake with Marzipan</div>
          <div class="product-description">Rich fruit cake with marzipan and fondant icing. With or without alcohol.</div>
        </div>
        <div>
          <select class="product-select" data-id="festive-2">
            <option value="6 inch|30">6 inch - ¬£30</option>
            <option value="8 inch|40">8 inch - ¬£40</option>
          </select>
          <button class="add-btn" data-name="Christmas Cake - Marzipan" data-id="festive-2">Add to Cart</button>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- Popular Items Dashboard -->
<div class="popular-dashboard">
  <h2>üìä Popular This Week</h2>
  <p>See what everyone's loving right now!</p>
  
  <div class="popular-stats">
    <div class="stat-card">
      <div class="stat-number" id="totalOrders">47</div>
      <div>Orders This Week</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" id="popularItem">Shortbread Delight</div>
      <div>Most Popular Item</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" id="trendingItem">Cupcakes</div>
      <div>Trending Now</div>
    </div>
    <div class="stat-card">
      <div class="stat-number" id="avgRating">5.0‚òÖ</div>
      <div>Average Rating</div>
    </div>
  </div>
</div>

<!-- Shop Call-to-Action -->
<section style="text-align: center; background: white; margin: 40px auto; max-width: 800px; padding: 60px 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
  <h2 style="color: #667eea; font-size: 2.5rem; margin-bottom: 20px;">üõçÔ∏è Browse Our Full Menu</h2>
  <p style="font-size: 1.3rem; color: #666; margin-bottom: 30px; line-height: 1.6;">
    Discover our complete range of artisan baked goods, from signature shortbreads to custom celebration cakes.
  </p>
  <a href="shop.html" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px 40px; border-radius: 30px; text-decoration: none; font-size: 1.2rem; font-weight: bold; display: inline-block; transition: transform 0.3s; box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);">
    Visit Our Shop ‚Üí
  </a>
</section>

<div id="order" class="cart-section" style="display: none;">
  <div class="cart-header">
    <h2>üõí Your Cart</h2>
    <span id="itemCount">0 items</span>
  </div>

  <div class="cart-items" id="cartContents">
    <p style="text-align: center; color: #999; padding: 30px;">Your cart is empty</p>
  </div>

  <div class="cart-total">
    <span>Total:</span>
    <span id="cartTotal">¬£0.00</span>
  </div>

  <div class="customer-form">
    <h3 style="color: #667eea; margin: 25px 0 15px;">Customer Details</h3>
    <input type="text" id="customerName" placeholder="Full Name *" required>
    <input type="email" id="customerEmail" placeholder="Email Address *" required>
    <input type="tel" id="customerMobile" placeholder="Mobile Number *" required pattern="[0-9]{11}" title="Please enter an 11-digit UK mobile number">
    <input type="text" id="customerAddress" placeholder="Delivery Address *" required>
    <textarea id="customerNotes" rows="3" placeholder="Special Requests / Toppings (optional)"></textarea>

    <label for="deliveryMethod">Delivery method *</label>
    <select id="deliveryMethod" name="deliveryMethod" required>
      <option value="" disabled selected>Select delivery method</option>
      <option value="collect">Collect</option>
      <option value="collect_market">Collect from market</option>
      <option value="delivery">Delivery</option>
    </select>

    <input type="text" id="deliveryDate" placeholder="Click to select delivery date (min 7 days) *" readonly style="cursor: pointer;">

    <div class="leadtime-group">
      <p>Is your delivery date at least one week from today?</p>
      <label><input type="radio" name="leadTime" id="leadTimeYes" checked> Yes</label>
      <label><input type="radio" name="leadTime" id="leadTimeNo"> No</label>
      <p id="leadTimeWarning" class="leadtime-note" style="display:none;">
        Please call <a href="tel:07842817789">07842817789</a> to discuss if we can make it earlier.
      </p>
    </div>

    <div class="checkbox-group">
      <label>
        <input type="checkbox" id="privacyCheck" required>
        I agree to the <a href="privacy.html" target="_blank" rel="noopener">Privacy Policy</a> *
      </label>
      <label>
        <input type="checkbox" id="termsCheck" required>
        I agree to the <a href="terms.html" target="_blank" rel="noopener">Terms & Conditions</a> *
      </label>
    </div>

    <button class="order-btn" id="placeOrderBtn">Place Order & Pay</button>
    
    <!-- Recommended Products Section -->
    <div class="recommendations-section" id="recommendedProducts" style="display: none;">
      <h3>üõçÔ∏è Customers who bought this also bought</h3>
      <div class="recommendations-grid" id="recommendationsGrid">
        <!-- Recommendations will be populated here -->
      </div>
    </div>
  </div>
</div>

<!-- Recently Viewed Items Section -->
<section id="recently-viewed" style="display: none;">
  <h2>üëÄ Recently Viewed</h2>
  <div class="products-grid" id="recentlyViewedGrid">
    <!-- Recently viewed items will be populated here -->
  </div>
</section>

<!-- Move Market Section here, after cart -->
<section id="market">
  <h2>üé™ Highworth Market</h2>
  <div style="text-align: center; margin-bottom: 30px;">
    <p style="font-size: 1.3rem; font-weight: bold; color: #667eea;">Every Saturday ‚Ä¢ 8am - 2pm</p>
    <p style="font-size: 1.1rem; margin-top: 10px; color: #666;">Come visit us for fresh bakes, friendly chats, and our famous Shortbread Delight!</p>
  </div>

  <button class="market-toggle" id="marketToggle">See This Week's Bakes</button>

  <div class="market-bakes" id="marketBakes">
    <div class="products-grid">
      <div class="product-tile">
        <img src="pictures/thisweekshort.jpg" alt="Shortbread Delight">
        <div class="product-overlay">
          <div>
            <div class="product-title">Famous Shortbread Delight ‚≠ê</div>
            <div class="product-description">Our signature buttery shortbread - the star of the market!</div>
          </div>
        </div>
      </div>

      <div class="product-tile">
        <img src="pictures/christmascake.jpg" alt="Brownies">
        <div class="product-overlay">
          <div>
            <div class="product-title">Sliced Christmas cake</div>
            <div class="product-description">Rich and moist, perfect for the festive season.</div>
          </div>
        </div>
      </div>

      <div class="product-tile">
        <img src="pictures/caramelised.jpg" alt="Cupcakes">
        <div class="product-overlay">
          <div>
            <div class="product-title">Caramelised biscuit (Biscoff-style) brownies</div>
            <div class="product-description">Decadent brownies with a caramelised biscuit twist.</div>
          </div>
        </div>
      </div>

      <div class="product-tile">
        <img src="pictures/thisweekiced.jpg" alt="Biscuits">
        <div class="product-overlay">
          <div>
            <div class="product-title">Biscuit Selection</div>
            <div class="product-description">Handmade biscuits perfect for a cosy treat.</div>
          </div>
        </div>
      </div>

      <div class="product-tile">
        <img src="pictures/slicedvanilla.jpg" alt="New Market Bake">
        <div class="product-overlay">
          <div>
            <div class="product-title">Weekly Special</div>
            <div class="product-description">Vanilla sponge with apricot jam ‚Äî fondant or buttercream topping</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="social-links">
    <p style="font-size: 1.2rem; color: #667eea; font-weight: bold;">Follow us for weekly bakes & updates! üç™</p>
    <div class="social-icons">
      <a href="https://instagram.com/cupcakesontheavenue" target="_blank">
        <img src="pictures/instagram.png" alt="Instagram" width="45" height="45">
      </a>
      <a href="https://www.facebook.com/profile.php?id=61578246007533" target="_blank">
        <svg width="45" height="45" viewBox="0 0 24 24" fill="#1877F2">
          <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
        </svg>
      </a>
      <a href="https://tiktok.com/@Cupcakesontheheaven" target="_blank">
        <img src="pictures/tiktok.png" alt="TikTok" width="45" height="45">
      </a>
    </div>
  </div>
</section>

<div class="calendar-overlay" id="calendarOverlay"></div>
<div class="calendar-popup" id="calendarPopup">
  <button class="close-calendar" id="closeCalendar">√ó</button>
  <div class="calendar-nav">
    <button id="prevMonth">‚óÄ</button>
    <span id="monthYear"></span>
    <button id="nextMonth">‚ñ∂</button>
  </div>
  <div id="calendar"></div>
</div>

<section id="special-request">
  <h2>üíå Special Request</h2>
  <p style="text-align: center; margin-bottom: 25px; color: #666; font-size: 1.1rem;">
    Have a custom order or special requirement? Let us know!
  </p>
  <form id="specialForm">
    <input type="text" id="srName" placeholder="Your Name *" required>
    <input type="email" id="srEmail" placeholder="Your Email *" required>
    <textarea id="srMessage" rows="5" placeholder="Describe your special request... *" required></textarea>
    <button type="submit">Send Request</button>
  </form>
</section>

<div id="toast"></div>

<footer class="site-footer">
  <nav>
    <a href="terms.html" target="_blank" rel="noopener">Terms & Conditions</a>
    <a href="privacy.html" target="_blank" rel="noopener">Privacy Policy</a>
    <a href="refunds.html" target="_blank" rel="noopener">Refunds & Cancellations</a>
    <a href="delivery.html" target="_blank" rel="noopener">Delivery & Collection</a>
    <a href="admin.html" class="admin-link" style="opacity: 0.3; font-size: 0.8rem; color: #999;" title="Admin Access">‚öôÔ∏è</a>
  </nav>
  <p>¬© Cupcakes on the Avenue</p>
  <img src="pictures\food hygiene.jpg"" alt="Cupcake illustration" style="width: 80px; margin-top: 12px; opacity: 0.8;">
</footer>

<script>
const BACKEND_BASE = 'https://sumup-backend.vercel.app'; // Try this instead

document.addEventListener('DOMContentLoaded', () => {
  let cart = JSON.parse(localStorage.getItem('cart') || '[]');
  let currentMonth = new Date().getMonth();
  let currentYear = new Date().getFullYear();
  let blockedDates = JSON.parse(localStorage.getItem('blockedDates') || '[]');

  // PWA Notification System
  async function initializeNotifications() {
    // Register service worker
    if ('serviceWorker' in navigator) {
      try {
        const registration = await navigator.serviceWorker.register('/sw.js');
        console.log('‚úÖ Service Worker registered:', registration.scope);
        
        // Request notification permission
        if ('Notification' in window) {
          const permission = await Notification.requestPermission();
          if (permission === 'granted') {
            console.log('‚úÖ Notification permission granted');
            
            // Store notification preference
            localStorage.setItem('notificationsEnabled', 'true');
            
            // Show welcome notification
            showWelcomeNotification();
            
            // Set up periodic checks for updates
            setupUpdateChecks();
          } else {
            console.log('‚ùå Notification permission denied');
          }
        }
      } catch (error) {
        console.error('‚ùå Service Worker registration failed:', error);
      }
    }
  }

  function showWelcomeNotification() {
    if (Notification.permission === 'granted') {
      new Notification('Welcome to Cupcakes on the Avenue! üßÅ', {
        body: 'You\'ll now receive notifications about weekly bakes, new products, and special offers!',
        icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">üßÅ</text></svg>',
        tag: 'welcome'
      });
    }
  }

  // Function to send notifications about updates
  function sendUpdateNotification(type, title, body) {
    if (Notification.permission === 'granted' && localStorage.getItem('notificationsEnabled') === 'true') {
      const notification = new Notification(title, {
        body: body,
        icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">üßÅ</text></svg>',
        badge: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">üßÅ</text></svg>',
        tag: type,
        vibrate: [200, 100, 200],
        data: { type: type }
      });

      notification.onclick = function() {
        window.focus();
        if (type === 'weekly-bakes') {
          // Scroll to market section
          document.getElementById('marketToggle').click();
        } else if (type === 'new-product' || type === 'discount') {
          // Go to shop
          window.location.href = '/shop.html';
        }
        notification.close();
      };
    }
  }

  // Setup periodic checks for updates
  function setupUpdateChecks() {
    // Check for weekly bakes updates (every hour)
    setInterval(() => {
      checkForWeeklyBakesUpdate();
    }, 60 * 60 * 1000); // 1 hour

    // Check for new products/discounts (every 30 minutes)
    setInterval(() => {
      checkForProductUpdates();
    }, 30 * 60 * 1000); // 30 minutes
  }

  function checkForWeeklyBakesUpdate() {
    const lastCheck = localStorage.getItem('lastWeeklyBakesCheck');
    const now = Date.now();
    
    // Check if it's been more than 24 hours since last check
    if (!lastCheck || (now - parseInt(lastCheck)) > 24 * 60 * 60 * 1000) {
      const currentWeek = getWeekNumber(new Date());
      const lastNotifiedWeek = localStorage.getItem('lastNotifiedWeek');
      
      if (lastNotifiedWeek !== currentWeek.toString()) {
        sendUpdateNotification(
          'weekly-bakes',
          'This Week\'s Fresh Bakes Are Here! üç∞',
          'New weekly selection available at Highworth Market every Saturday!'
        );
        localStorage.setItem('lastNotifiedWeek', currentWeek.toString());
      }
      
      localStorage.setItem('lastWeeklyBakesCheck', now.toString());
    }
  }

  function checkForProductUpdates() {
    // This would typically check your server for new products or discounts
    // For demo purposes, we'll simulate random notifications
    const random = Math.random();
    
    if (random < 0.1) { // 10% chance every 30 minutes
      const notifications = [
        {
          type: 'new-product',
          title: 'New Product Alert! üÜï',
          body: 'Check out our latest delicious creation in the shop!'
        },
        {
          type: 'discount',
          title: 'Special Offer! üí∞',
          body: '15% off all cupcakes this weekend only!'
        },
        {
          type: 'market-special',
          title: 'Market Special Today! üé™',
          body: 'Fresh shortbread delight available at Highworth Market!'
        }
      ];
      
      const randomNotification = notifications[Math.floor(Math.random() * notifications.length)];
      sendUpdateNotification(randomNotification.type, randomNotification.title, randomNotification.body);
    }
  }

  function getWeekNumber(date) {
    const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
    const dayNum = d.getUTCDay() || 7;
    d.setUTCDate(d.getUTCDate() + 4 - dayNum);
    const yearStart = new Date(Date.UTC(d.getUTCFullYear(),0,1));
    return Math.ceil((((d - yearStart) / 86400000) + 1)/7);
  }

  // Manual notification triggers for admin use
  window.notifyWeeklyBakes = () => {
    sendUpdateNotification(
      'weekly-bakes',
      'Weekly Bakes Updated! üßÅ',
      'Fresh new selection ready at Highworth Market this Saturday!'
    );
  };

  window.notifyNewProduct = (productName) => {
    sendUpdateNotification(
      'new-product',
      'New Product Launch! üéâ',
      `Introducing ${productName || 'our latest delicious creation'}! Available now in our shop.`
    );
  };

  window.notifyDiscount = (discount) => {
    sendUpdateNotification(
      'discount',
      'Special Offer! üí∞',
      `${discount || 'Special discount'} available now! Don't miss out on these sweet savings.`
    );
  };

  // Initialize notifications when page loads
  initializeNotifications();

  // Seasonal Theme System
  function setSeasonalTheme() {
    const month = new Date().getMonth(); // 0-11
    const body = document.body;
    
    // Remove existing seasonal classes
    body.classList.remove('spring', 'summer', 'autumn', 'winter');
    
    if (month >= 2 && month <= 4) { // March, April, May
      body.classList.add('spring');
    } else if (month >= 5 && month <= 7) { // June, July, August
      body.classList.add('summer');
    } else if (month >= 8 && month <= 10) { // September, October, November
      body.classList.add('autumn');
    } else { // December, January, February
      body.classList.add('winter');
    }
  }
  
  // Update sticky cart display
  function updateStickyCart() {
    const stickyCartCount = document.getElementById('stickyCartCount');
    const stickyCartTotal = document.getElementById('stickyCartTotal');
    const stickyCart = document.getElementById('stickyCart');
    
    if (!stickyCartCount || !stickyCartTotal || !stickyCart) return;
    
    const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
    const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    
    stickyCartCount.textContent = `${totalItems} item${totalItems !== 1 ? 's' : ''}`;
    stickyCartTotal.textContent = `¬£${totalPrice.toFixed(2)}`;
    
    // Show/hide sticky cart based on cart contents
    if (totalItems > 0) {
      stickyCart.classList.add('show');
    } else {
      stickyCart.classList.remove('show');
    }
  }
  
  // Set theme on load
  setSeasonalTheme();
  
  // Initialize sticky cart display
  updateStickyCart();

  // Size Comparison System
  function createSizeTooltip() {
    const tooltip = document.createElement('div');
    tooltip.className = 'size-tooltip';
    document.body.appendChild(tooltip);
    return tooltip;
  }

  const sizeTooltip = createSizeTooltip();

  // Add hover events to product selects for size comparison
  document.querySelectorAll('.product-select').forEach(select => {
    select.addEventListener('mouseenter', (e) => {
      const selectedOption = e.target.selectedOptions[0];
      const sizeText = selectedOption.text;
      
      if (sizeText.includes('inch')) {
        const size = sizeText.match(/(\d+)\s*inch/)[1];
        sizeTooltip.innerHTML = `
          <strong>${sizeText}</strong>
          <div class="size-visual">
            <span>Size: </span>
            <div class="size-circle size-${size}"></div>
          </div>
          <div style="margin-top: 5px; font-size: 0.8rem;">
            ${size}" diameter ‚Ä¢ Serves ${size === '6' ? '6-8' : size === '8' ? '8-12' : '12-16'} people
          </div>
        `;
        
        const rect = e.target.getBoundingClientRect();
        sizeTooltip.style.left = rect.left + 'px';
        sizeTooltip.style.top = (rect.top - 100) + 'px';
        sizeTooltip.classList.add('show');
      }
    });

    select.addEventListener('mouseleave', () => {
      sizeTooltip.classList.remove('show');
    });
  });

  // Recently Viewed Items System
  let recentlyViewed = JSON.parse(localStorage.getItem('recentlyViewed') || '[]');

  function addToRecentlyViewed(productData) {
    // Remove if already exists
    recentlyViewed = recentlyViewed.filter(item => item.name !== productData.name);
    
    // Add to beginning
    recentlyViewed.unshift(productData);
    
    // Keep only last 4 items
    recentlyViewed = recentlyViewed.slice(0, 4);
    
    localStorage.setItem('recentlyViewed', JSON.stringify(recentlyViewed));
    updateRecentlyViewedDisplay();
  }

  function updateRecentlyViewedDisplay() {
    const section = document.getElementById('recently-viewed');
    const grid = document.getElementById('recentlyViewedGrid');
    
    if (recentlyViewed.length === 0) {
      section.style.display = 'none';
      return;
    }
    
    section.style.display = 'block';
    grid.innerHTML = recentlyViewed.map(item => `
      <div class="product-tile">
        <img src="${item.image}" alt="${item.name}">
        <div class="product-overlay">
          <div>
            <div class="product-title">${item.name}</div>
            <div class="product-description">${item.description}</div>
          </div>
        </div>
      </div>
    `).join('');
  }

  // Track product views
  document.querySelectorAll('.product-tile').forEach(tile => {
    tile.addEventListener('mouseenter', () => {
      const img = tile.querySelector('img');
      const title = tile.querySelector('.product-title');
      const description = tile.querySelector('.product-description');
      
      if (img && title && description) {
        addToRecentlyViewed({
          name: title.textContent,
          description: description.textContent,
          image: img.src
        });
      }
    });
  });

  // Initialize recently viewed display
  updateRecentlyViewedDisplay();

  // Account System
  let currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
  let users = JSON.parse(localStorage.getItem('users') || '[]');
  let isGuest = localStorage.getItem('isGuest') === 'true';

  // Account tab switching
  document.querySelectorAll('.account-tab').forEach(tab => {
    tab.addEventListener('click', () => {
      const targetTab = tab.getAttribute('data-tab');
      
      // Update active tab
      document.querySelectorAll('.account-tab').forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      
      // Show target content
      document.querySelectorAll('.account-content').forEach(c => c.classList.remove('active'));
      document.getElementById(targetTab).classList.add('active');
    });
  });

  // Account link functionality
  document.getElementById('accountLink').addEventListener('click', (e) => {
    e.preventDefault();
    const accountSection = document.getElementById('account');
    accountSection.style.display = accountSection.style.display === 'block' ? 'none' : 'block';
    accountSection.scrollIntoView({ behavior: 'smooth' });
  });

  // Guest checkout
  document.getElementById('guestCheckoutBtn').addEventListener('click', () => {
    isGuest = true;
    localStorage.setItem('isGuest', 'true');
    document.getElementById('account').style.display = 'none';
    document.getElementById('order').scrollIntoView({ behavior: 'smooth' });
    showToast('Continuing as guest - you can still place orders!');
  });

  // Loyalty points system
  function updateLoyaltyPoints() {
    const points = currentUser ? currentUser.loyaltyPoints || 0 : 0;
    const pointsElement = document.getElementById('loyaltyPoints');
    if (pointsElement) pointsElement.textContent = `${points} Points`;
  }

  function addLoyaltyPoints(orderTotal) {
    if (currentUser) {
      currentUser.loyaltyPoints = (currentUser.loyaltyPoints || 0) + Math.floor(orderTotal);
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      updateLoyaltyPoints();
    }
  }

  // Order history
  function addToOrderHistory(order) {
    if (currentUser) {
      currentUser.orderHistory = currentUser.orderHistory || [];
      currentUser.orderHistory.unshift({
        ...order,
        date: new Date().toLocaleDateString(),
        status: 'Order Placed'
      });
      localStorage.setItem('currentUser', JSON.stringify(currentUser));
      updateOrderHistory();
    }
  }

  function updateOrderHistory() {
    const historyList = document.getElementById('orderHistoryList');
    if (!currentUser || !currentUser.orderHistory || currentUser.orderHistory.length === 0) {
      historyList.innerHTML = '<p style="color: #999; text-align: center; padding: 20px;">No orders yet</p>';
      return;
    }
    
    historyList.innerHTML = currentUser.orderHistory.map(order => `
      <div class="order-item">
        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
          <strong>Order #${order.id || 'N/A'}</strong>
          <span style="color: #667eea;">${order.status}</span>
        </div>
        <p>Date: ${order.date}</p>
        <p>Total: ¬£${order.total}</p>
        <p>Items: ${order.items.map(item => `${item.name} x${item.quantity}`).join(', ')}</p>
      </div>
    `).join('');
  }

  // Initialize account display
  if (currentUser) {
    updateLoyaltyPoints();
    updateOrderHistory();
  }

  // Wishlist System
  let wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');

  function toggleWishlist(productName, heartElement) {
    const index = wishlist.indexOf(productName);
    if (index > -1) {
      wishlist.splice(index, 1);
      heartElement.textContent = '‚ô°';
      heartElement.classList.remove('loved');
      showToast(`Removed ${productName} from wishlist`);
    } else {
      wishlist.push(productName);
      heartElement.textContent = '‚ô•';
      heartElement.classList.add('loved');
      showToast(`Added ${productName} to wishlist`);
    }
    localStorage.setItem('wishlist', JSON.stringify(wishlist));
  }

  // Initialize wishlist hearts
  document.querySelectorAll('.wishlist-heart').forEach(heart => {
    const productName = heart.getAttribute('data-product');
    if (wishlist.includes(productName)) {
      heart.textContent = '‚ô•';
      heart.classList.add('loved');
    }
    
    heart.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleWishlist(productName, heart);
    });
  });

  // Recommended Products System
  const productRecommendations = {
    'Shortbread Delight': ['Iced Shortbread', 'Rice Crispy Treats', 'Cupcakes'],
    'Iced Shortbread': ['Shortbread Delight', 'Sweet Trimming Pots', 'Cupcakes'],
    'Rice Crispy Treats': ['Cupcakes', 'Sweet Trimming Pots', 'Shortbread Delight'],
    'Cupcakes': ['Celebration Cake', 'Sweet Trimming Pots', 'Shortbread Delight'],
    'Celebration Cake': ['Cupcakes', 'Sweet Trimming Pots', 'Christmas Cake with Royal Icing'],
    'Sweet Trimming Pots': ['Cupcakes', 'Rice Crispy Treats', 'Iced Shortbread'],
    'Christmas Cake with Royal Icing': ['Christmas Cake with Marzipan', 'Celebration Cake', 'Cupcakes'],
    'Christmas Cake with Marzipan': ['Christmas Cake with Royal Icing', 'Celebration Cake', 'Shortbread Delight']
  };

  const productImages = {
    'Shortbread Delight': 'pictures/shortbread.jpg',
    'Iced Shortbread': 'pictures/icedshortbread.jpg',
    'Rice Crispy Treats': 'pictures/ricecrispy.jpg',
    'Cupcakes': 'pictures/cupcakes.jpg',
    'Celebration Cake': 'pictures/purplecake.jpg',
    'Sweet Trimming Pots': 'pictures/sweettrimmings.jpg',
    'Christmas Cake with Royal Icing': 'pictures/marzipan.jpg',
    'Christmas Cake with Marzipan': 'pictures/fondant.jpg'
  };

  function showRecommendations(productName) {
    const recommendations = productRecommendations[productName];
    if (!recommendations) return;

    const section = document.getElementById('recommendedProducts');
    const grid = document.getElementById('recommendationsGrid');
    
    grid.innerHTML = recommendations.map(product => `
      <div class="recommendation-item" onclick="scrollToProduct('${product}')">
        <img src="${productImages[product] || 'pictures/default.jpg'}" alt="${product}">
        <h5>${product}</h5>
        <p style="font-size: 0.9rem; color: #666;">Popular choice</p>
      </div>
    `).join('');
    
    section.style.display = 'block';
  }

  function scrollToProduct(productName) {
    const productTiles = document.querySelectorAll('.product-title');
    for (let tile of productTiles) {
      if (tile.textContent.includes(productName)) {
        tile.closest('.product-tile').scrollIntoView({ behavior: 'smooth' });
        // Add highlight effect
        const productTile = tile.closest('.product-tile');
        productTile.style.transform = 'scale(1.05)';
        productTile.style.boxShadow = '0 20px 50px rgba(102, 126, 234, 0.6)';
        setTimeout(() => {
          productTile.style.transform = '';
          productTile.style.boxShadow = '';
        }, 2000);
        break;
      }
    }
  }

  // Loading Animations & Skeleton Screens
  function showLoadingSpinner(element) {
    element.innerHTML = '<div class="loading-spinner"></div>';
  }

  function createSkeletonProduct() {
    return `
      <div class="skeleton skeleton-product"></div>
    `;
  }

  function showSkeletonGrid(container, count = 6) {
    container.innerHTML = Array(count).fill(createSkeletonProduct()).join('');
  }

  // Add fade-in animation to product tiles
  function animateProducts() {
    const products = document.querySelectorAll('.product-tile');
    products.forEach((product, index) => {
      product.style.opacity = '0';
      setTimeout(() => {
        product.classList.add('fade-in');
        product.style.opacity = '1';
      }, index * 100);
    });
  }

  // Simulate loading states for sections
  function simulateLoading(sectionId, callback, delay = 1500) {
    const section = document.querySelector(sectionId);
    if (!section) return;
    
    const grid = section.querySelector('.products-grid');
    if (grid) {
      showSkeletonGrid(grid);
      setTimeout(() => {
        callback();
        animateProducts();
      }, delay);
    }
  }

  // Apply animations to cart items
  function animateCartItem(element) {
    element.classList.add('slide-in');
  }

  // Apply animations to toast notifications
  function enhancedShowToast(message, type = 'success') {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.className = `show zoom-in ${type}`;
    
    setTimeout(() => {
      toast.classList.remove('show', 'zoom-in', type);
    }, 3000);
  }

  // Countdown Timer System
  function initCountdownTimer() {
    // Set end time to end of October 31st (Halloween)
    const endTime = new Date('2025-11-01T00:00:00').getTime();
    
    function updateCountdown() {
      const now = new Date().getTime();
      const timeLeft = endTime - now;
      
      if (timeLeft <= 0) {
        document.getElementById('countdownBanner').style.display = 'none';
        return;
      }
      
      const hours = Math.floor(timeLeft / (1000 * 60 * 60));
      const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
      
      document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
      document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
      document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
    }
    
    updateCountdown();
    setInterval(updateCountdown, 1000);
  }
  
  // Initialize countdown timer
  initCountdownTimer();

  // Enhanced loading for page sections
  function initPageAnimations() {
    // Animate products on page load
    setTimeout(() => {
      animateProducts();
    }, 500);
    
    // Animate sections on scroll
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('fade-in');
        }
      });
    }, observerOptions);
    
    document.querySelectorAll('section').forEach(section => {
      observer.observe(section);
    });
  }
  
  // Initialize page animations
  initPageAnimations();

  const WEBHOOK_URL = "https://discord.com/api/webhooks/1426192909044023297/Ilgqgr8p7buI95ai-zssfphPLzQlNBBZf6PY31BhVuptPd-ZyccSq5kAQJPoBkUt4PHK";

  // Add to cart
  document.querySelectorAll('.add-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const name = btn.getAttribute('data-name');
      const selectId = btn.getAttribute('data-id');
      const select = document.querySelector(`[data-id="${selectId}"]`);
      const [size, price] = select.value.split('|');
      
      const item = {
        name: `${name} (${size})`,
        price: parseFloat(price),
        quantity: 1
      };

      const existing = cart.find(i => i.name === item.name);
      if (existing) {
        existing.quantity++;
      } else {
        cart.push(item);
      }

      updateCart();
      localStorage.setItem('cart', JSON.stringify(cart));
      showToast(`‚úÖ ${name} added to cart!`);
      
      // Track add to cart event
      if (typeof trackAddToCart === 'function') {
        trackAddToCart(name, parseFloat(price));
      }
      
      // Show recommendations based on added product
      showRecommendations(name);
    });
  });

  // Update cart display
  function updateCart() {
    const cartContents = document.getElementById('cartContents');
    const cartTotal = document.getElementById('cartTotal');
    const itemCount = document.getElementById('itemCount');

    // Update sticky cart
    updateStickyCart();

    if (cart.length === 0) {
      cartContents.innerHTML = '<p style="text-align: center; color: #999; padding: 30px;">Your cart is empty</p>';
      cartTotal.textContent = '¬£0.00';
      itemCount.textContent = '0 items';
      return;
    }

    let html = '<ul>';
    let total = 0;
    let count = 0;

    cart.forEach((item, index) => {
      total += item.price * item.quantity;
      count += item.quantity;
      html += `
        <li>
          <span>${item.name}</span>
          <span>¬£${item.price.toFixed(2)} √ó ${item.quantity}</span>
          <div class="cart-controls">
            <button class="cart-btn" onclick="changeQty(${index}, 1)">+</button>
            <button class="cart-btn" onclick="changeQty(${index}, -1)">‚àí</button>
          </div>
        </li>
      `;
    });

    html += '</ul>';
    cartContents.innerHTML = html;
    cartTotal.textContent = `¬£${total.toFixed(2)}`;
    itemCount.textContent = `${count} item${count !== 1 ? 's' : ''}`;
  }

  // Change quantity
  window.changeQty = (index, delta) => {
    cart[index].quantity += delta;
    if (cart[index].quantity <= 0) {
      cart.splice(index, 1);
    }
    updateCart();
    localStorage.setItem('cart', JSON.stringify(cart));
  };

  // Market toggle
  document.getElementById('marketToggle').addEventListener('click', function() {
    const bakes = document.getElementById('marketBakes');
    if (bakes.classList.contains('show')) {
      bakes.classList.remove('show');
      this.textContent = 'See This Week\'s Bakes';
    } else {
      bakes.classList.add('show');
      this.textContent = 'Hide This Week\'s Bakes';
    }
  });

  // Calendar
  document.getElementById('deliveryDate').addEventListener('click', () => {
    document.getElementById('calendarOverlay').style.display = 'block';
    document.getElementById('calendarPopup').style.display = 'block';
    renderCalendar();
  });

  document.getElementById('closeCalendar').addEventListener('click', closeCalendar);
  document.getElementById('calendarOverlay').addEventListener('click', closeCalendar);

  function closeCalendar() {
    document.getElementById('calendarOverlay').style.display = 'none';
    document.getElementById('calendarPopup').style.display = 'none';
  }

  document.getElementById('prevMonth').addEventListener('click', () => {
    currentMonth--;
    if (currentMonth < 0) {
      currentMonth = 11;
      currentYear--;
    }
    renderCalendar();
  });

  document.getElementById('nextMonth').addEventListener('click', () => {
    currentMonth++;
    if (currentMonth > 11) {
      currentMonth = 0;
      currentYear++;
    }
    renderCalendar();
  });

  function renderCalendar() {
    const cal = document.getElementById('calendar');
    const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
    document.getElementById('monthYear').textContent = `${monthNames[currentMonth]} ${currentYear}`;

    const firstDay = new Date(currentYear, currentMonth, 1).getDay();
    const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();

    // Today at midnight
    const today = new Date();
    today.setHours(0,0,0,0);
    // Minimum selectable date = today + 7 days
    const minDate = new Date(today);
    minDate.setDate(minDate.getDate() + 7);

    let html = '<table><tr><th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th></tr><tr>';

    for (let i = 0; i < firstDay; i++) {
      html += '<td></td>';
    }

    for (let day = 1; day <= daysInMonth; day++) {
      const date = new Date(currentYear, currentMonth, day);
      date.setHours(0,0,0,0);
      const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
      const isBlocked = blockedDates.includes(dateStr);
      const isWeekend = date.getDay() === 0 || date.getDay() === 6;

      // Disable any date earlier than minDate (today + 7)
      const isBeforeMin = date < minDate;

      let className = '';
      if (isBeforeMin || isBlocked) className = 'disabled';
      else if (isWeekend) className = 'weekend';

      html += `<td class="${className}" data-date="${dateStr}">${day}</td>`;

      if ((firstDay + day) % 7 === 0) {
        html += '</tr><tr>';
      }
    }

    html += '</tr></table>';
    cal.innerHTML = html;

    cal.querySelectorAll('td[data-date]').forEach(td => {
      if (!td.classList.contains('disabled')) {
        td.addEventListener('click', () => {
          document.getElementById('deliveryDate').value = td.getAttribute('data-date');
          closeCalendar();
        });
      }
    });
  }

  // Place order
  document.getElementById('placeOrderBtn').addEventListener('click', async () => {
    const name = document.getElementById('customerName').value.trim();
    const email = document.getElementById('customerEmail').value.trim();
    const mobile = document.getElementById('customerMobile').value.trim();
    const address = document.getElementById('customerAddress').value.trim();
    const notes = document.getElementById('customerNotes').value.trim();
    const delivery = document.getElementById('deliveryMethod').value;
    const date = document.getElementById('deliveryDate').value;
    const privacy = document.getElementById('privacyCheck').checked;
    const terms = document.getElementById('termsCheck').checked;

    if (!name || !email || !mobile || !address || !delivery || !date) {
      showToast('‚ö†Ô∏è Please fill all required fields!');
      return;
    }

    if (!/^[0-9]{11}$/.test(mobile)) {
      showToast('‚ö†Ô∏è Please enter a valid 11-digit UK mobile number!');
      return;
    }

    if (!privacy || !terms) {
      showToast('‚ö†Ô∏è Please accept Privacy Policy and Terms!');
      return;
    }

    if (cart.length === 0) {
      showToast('‚ö†Ô∏è Your cart is empty!');
      return;
    }

    const total = cart.reduce((sum, i) => sum + (i.price * i.quantity), 0);
    const items = cart.map((i, idx) => `${idx + 1}. ${i.name} √ó ${i.quantity} = ¬£${(i.price * i.quantity).toFixed(2)}`).join('\n');

    const message = `üßÅ **NEW ORDER** üßÅ

**Customer:** ${name}
**Email:** ${email}
**Mobile:** ${mobile}
**Address:** ${address}
**Delivery:** ${delivery}
**Date:** ${date}
**Notes:** ${notes || 'None'}

**ORDER:**
${items}

**TOTAL: ¬£${total.toFixed(2)}**`;

    const orderBtn = document.getElementById('placeOrderBtn');
    orderBtn.disabled = true;
    orderBtn.textContent = 'Processing...';

    try {
      console.log('Sending order to Discord...');
      
      // Send to Discord
      const discordResponse = await fetch(WEBHOOK_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ content: message })
      });

      if (!discordResponse.ok) {
        throw new Error('Discord webhook failed');
      }

      console.log('‚úÖ Discord message sent');

      // Send email (non-blocking)
      fetch(`${BACKEND_BASE}/api/send-email`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          email, name, mobile, orderItems: items,
          total: `¬£${total.toFixed(2)}`, delivery, date, address,
          notes: notes || 'None', businessPhone: '07842817789'
        })
      }).then(() => console.log('‚úÖ Email sent'))
        .catch(err => console.warn('‚ö†Ô∏è Email failed:', err));

      // Redirect to SumUp payment
      const reference = 'ORDER-' + Date.now();
      const paymentUrl = `${BACKEND_BASE}/api/checkout?total=${total.toFixed(2)}&reference=${reference}`;
      
      console.log('Redirecting to:', paymentUrl);
      window.location.href = paymentUrl;

    } catch (error) {
      console.error('‚ùå Order failed:', error);
      showToast('‚ö†Ô∏è Failed to place order. Please try again.');
      orderBtn.disabled = false;
      orderBtn.textContent = 'Place Order & Pay';
    }
  });

  // Special request form
  document.getElementById('specialForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const name = document.getElementById('srName').value.trim();
    const email = document.getElementById('srEmail').value.trim();
    const message = document.getElementById('srMessage').value.trim();

    if (!name || !email || !message) {
      showToast('‚ö†Ô∏è Please fill all fields!');
      return;
    }

    const webhookMessage = `üíå **SPECIAL REQUEST**\n\n**Name:** ${name}\n**Email:** ${email}\n**Message:**\n${message}`;

    try {
      await fetch(WEBHOOK_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ content: webhookMessage })
      });

      showToast('‚úÖ Request sent successfully!');
      document.getElementById('specialForm').reset();
    } catch (error) {
      showToast('‚ö†Ô∏è Failed to send request.');
    }
  });

  // Payment integration
  function initiatePayment(total, orderReference) {
    window.location.href = `${BACKEND_BASE}/api/create-checkout?total=${total}&reference=${orderReference}`;
  }

  // Email notification
  async function sendOrderConfirmation(orderData) {
    await fetch('https://sumup-backend-ka4im7xlf-jack-wicks-projects.vercel.app/api/send-email', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(orderData)
    });
  }

  // Toast notification
  function showToast(message, duration = 3000) {
    const toast = document.getElementById('toast');
    toast.textContent = message;
    toast.classList.add('show');
    setTimeout(() => {
      toast.classList.remove('show');
    }, duration);
  }

  // Snowflakes animation
  function createSnowflake() {
    const snowflake = document.createElement('div');
    snowflake.classList.add('snowflake');
    snowflake.textContent = '‚ùÑ';
    snowflake.style.left = Math.random() * window.innerWidth + 'px';
    snowflake.style.animationDuration = Math.random() * 3 + 2 + 's';
    snowflake.style.opacity = Math.random();
    snowflake.style.fontSize = Math.random() * 10 + 10 + 'px';
    document.body.appendChild(snowflake);

    setTimeout(() => {
      snowflake.remove();
    }, 5000);
  }

  setInterval(createSnowflake, 300);

  // Lead time radio toggle (show phone if "No")
  const leadTimeYes = document.getElementById('leadTimeYes');
  const leadTimeNo = document.getElementById('leadTimeNo');
  const leadTimeWarning = document.getElementById('leadTimeWarning');

  function updateLeadTimeWarning() {
    if (leadTimeNo && leadTimeNo.checked) {
      leadTimeWarning.style.display = 'block';
    } else {
      leadTimeWarning.style.display = 'none';
    }
  }
  if (leadTimeYes && leadTimeNo) {
    leadTimeYes.addEventListener('change', updateLeadTimeWarning);
    leadTimeNo.addEventListener('change', updateLeadTimeWarning);
    updateLeadTimeWarning();
  }
});

function getDeliveryLabel(val) {
  switch (val) {
    case 'collect': return 'Collect';
    case 'collect_market': return 'Collect from market';
    case 'delivery': return 'Delivery';
    default: return val || 'N/A';
  }
}

// Example usage when submitting:
async function submitOrder(orderData) {
  // ...existing code...
  const deliveryVal = document.getElementById('deliveryMethod').value;
  const deliveryLabel = getDeliveryLabel(deliveryVal);

  // include deliveryLabel in email/discord payloads
  // ...existing code...
}
</script>
</body>
</html>